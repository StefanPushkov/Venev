<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0078)http://mycontroller.ru/stm32-timer-general-purpose-vneshnyaya-sinhronizatsiya/ -->
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="ru-RU" class="chrome  win"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
<title>STM32 TIMER. general purpose. Внешняя синхронизация</title>
<script type="text/javascript" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/script.js"></script>
<link rel="stylesheet" href="./STM32 TIMER. general purpose. Внешняя синхронизация_files/style.css" type="text/css" media="screen">
<!--[if IE 6]><link rel="stylesheet" href="http://mycontroller.ru/wp-content/themes/MyController/style.ie6.css" type="text/css" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="http://mycontroller.ru/wp-content/themes/MyController/style.ie7.css" type="text/css" media="screen" /><![endif]-->
<link rel="alternate" type="application/rss+xml" title="RSS-лента My Controller" href="http://mycontroller.ru/feed/">
<link rel="alternate" type="application/atom+xml" title="Atom-лента My Controller" href="http://mycontroller.ru/feed/atom/"> 
<link rel="pingback" href="http://mycontroller.ru/xmlrpc.php">
<link rel="alternate" type="application/rss+xml" title="My Controller » Лента комментариев к «STM32 TIMER. general purpose. Внешняя синхронизация»" href="http://mycontroller.ru/stm32-timer-general-purpose-vneshnyaya-sinhronizatsiya/feed/">
<link rel="stylesheet" id="msw_wpfm_scan-css" href="./STM32 TIMER. general purpose. Внешняя синхронизация_files/wordpress-file-monitor.php" type="text/css" media="all">
<link rel="stylesheet" id="bwp-syntax-css" href="./STM32 TIMER. general purpose. Внешняя синхронизация_files/bwp-syntax.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-downloadmanager-css" href="./STM32 TIMER. general purpose. Внешняя синхронизация_files/download-css.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-pagenavi-css" href="./STM32 TIMER. general purpose. Внешняя синхронизация_files/pagenavi-css.css" type="text/css" media="all">
<script type="text/javascript" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/jquery.js"></script>
<script type="text/javascript" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/bwp-syntax.js"></script>
<script type="text/javascript" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/external-tracking.min.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://mycontroller.ru/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://mycontroller.ru/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="STM32 TIMER general-purpose. Система тактирования" href="http://mycontroller.ru/stm32-timer-general-purpose-sistema-taktirovaniya/">
<link rel="next" title="STM32 TIMER general purpose. Генерирование события обновления UEV" href="http://mycontroller.ru/stm32-timer-general-purpose-generirovanie-sobyitiya-obnovleniya-uev/">
<meta name="generator" content="WordPress 3.3.1">
<link rel="canonical" href="./STM32 TIMER. general purpose. Внешняя синхронизация_files/STM32 TIMER. general purpose. Внешняя синхронизация.htm">
<link rel="shortlink" href="http://mycontroller.ru/?p=2402">

<link rel="stylesheet" href="./STM32 TIMER. general purpose. Внешняя синхронизация_files/wp-syntax.css" type="text/css" media="screen">
<!-- wpSpoiler Code -->
        <script type="text/javascript">
            function wpSpoilerToggle(spoiler, link, showtext, hidetext) {
                if (spoiler.style.display != 'none') {
                    spoiler.style.display = 'none';
                    link.innerHTML = showtext;
                    link.className = 'spoiler_link_show';
                } else {
                    spoiler.style.display = 'block';
                    link.innerHTML = hidetext;
                    link.className = 'spoiler_link_hide';
                }
            }
          </script>
	<link type="text/css" rel="stylesheet" href="./STM32 TIMER. general purpose. Внешняя синхронизация_files/shCore.css">
	<link type="text/css" rel="stylesheet" href="./STM32 TIMER. general purpose. Внешняя синхронизация_files/shThemeDefault.css">
<!-- Google Analytics Tracking by Google Analyticator 6.0.2: http://ronaldheft.com/code/analyticator/ -->
<script type="text/javascript">window.google_analytics_uacct = "UA-29082067-1";</script>
<script type="text/javascript">
	var analyticsFileTypes = [''];
	var analyticsEventTracking = 'enabled';
</script>
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-29082067-1']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script><script type="text/javascript" async="" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/ga.js"></script>
</head>
<body>
<div id="art-page-background-simple-gradient">
</div>
<div id="art-main">
<div class="art-Sheet">
    <div class="art-Sheet-tl"></div>
    <div class="art-Sheet-tr"></div>
    <div class="art-Sheet-bl"></div>
    <div class="art-Sheet-br"></div>
    <div class="art-Sheet-tc"></div>
    <div class="art-Sheet-bc"></div>
    <div class="art-Sheet-cl"></div>
    <div class="art-Sheet-cr"></div>
    <div class="art-Sheet-cc"></div>
    <div class="art-Sheet-body">
<div class="art-Header">
    <div class="art-Header-png"></div>
    <div class="art-Header-jpeg"></div>
<div class="art-Logo">
    <h1 id="name-text" class="art-Logo-name">
        <a href="http://mycontroller.ru/">My Controller</a></h1>
    <div id="slogan-text" class="art-Logo-text">
        Изучаем микроконтроллеры STM32</div>
</div>

</div>
<div class="art-nav">
	<div class="l"></div>
	<div class="r"></div>
	<ul class="art-menu">
		<li><a href="http://mycontroller.ru/"><span class="l"></span><span class="r"></span><span class="t">Home</span></a></li><li><span class="art-menu-separator"></span></li><li class="page_item page-item-10"><a href="http://mycontroller.ru/o-sayte/"><span class="l"></span><span class="r"></span><span class="t">О сайте</span></a></li><li><span class="art-menu-separator"></span></li>
<li class="page_item page-item-186"><a href="http://mycontroller.ru/programmyi/"><span class="l"></span><span class="r"></span><span class="t">СОФТ</span></a></li>
	</ul>
</div>
<div class="art-contentLayout">
<div class="art-content">

<div class="art-Post">
    <div class="art-Post-tl"></div>
    <div class="art-Post-tr"></div>
    <div class="art-Post-bl"></div>
    <div class="art-Post-br"></div>
    <div class="art-Post-tc"></div>
    <div class="art-Post-bc"></div>
    <div class="art-Post-cl"></div>
    <div class="art-Post-cr"></div>
    <div class="art-Post-cc"></div>
    <div class="art-Post-body">
<div class="art-Post-inner art-article">

<div class="art-PostContent">

<div class="navigation">
	<div class="alignleft">« <a href="http://mycontroller.ru/stm32-timer-general-purpose-sistema-taktirovaniya/" rel="prev">STM32 TIMER general-purpose. Система тактирования</a></div>
	<div class="alignright"><a href="http://mycontroller.ru/stm32-timer-general-purpose-generirovanie-sobyitiya-obnovleniya-uev/" rel="next">STM32 TIMER general purpose. Генерирование события обновления UEV</a> »</div>
</div>

</div>
<div class="cleared"></div>


</div>

		<div class="cleared"></div>
    </div>
</div>

<div class="art-Post">
    <div class="art-Post-tl"></div>
    <div class="art-Post-tr"></div>
    <div class="art-Post-bl"></div>
    <div class="art-Post-br"></div>
    <div class="art-Post-tc"></div>
    <div class="art-Post-bc"></div>
    <div class="art-Post-cl"></div>
    <div class="art-Post-cr"></div>
    <div class="art-Post-cc"></div>
    <div class="art-Post-body">
<div class="art-Post-inner art-article">
<h2 class="art-PostHeader">
<a href="./STM32 TIMER. general purpose. Внешняя синхронизация_files/STM32 TIMER. general purpose. Внешняя синхронизация.htm" rel="bookmark" title="Постоянная ссылка на STM32 TIMER. general purpose. Внешняя синхронизация">
STM32 TIMER. general purpose. Внешняя синхронизация</a>
</h2>
<div class="art-PostContent">

          <p>В зависимости от способа синхронизации, возможно два режима работы таймеров: независимый и подчиненный (или <em>Slave mode</em>).</p>
<p>В независимом режиме таймер производит подсчет тактовых импульсов CK_INT независимо от других устройств. Он может выполнять счет вверх, вниз, выполнять захват входных сигналов, формировать ШИМ, генерировать запросы прерывания и DMA, управлять другими таймерами.</p>
<p>В подчиненном режиме таймер может выполнять те же действия, что и в независимом, но при этом он синхронизируется от внешнего сигнала, в качестве которого может быть выбран:</p>
<p></p>
<p><span id="more-2402"></span>
</p>
<ul>
<li><font color="#000000">один из внутренних таймеров;</font> </li>
<li><font color="#000000">сигнал на выводе контроллера (ETR, TI1 или TI2)</font> </li>
</ul>
<p>Перечисленные выше источники могут оказывать на таймер <strong>одно</strong> из следующих действий:</p>
<ul>
<li><font color="#000000">выступать в качестве источника тактовых импульсов для счетного регистра;</font> </li>
<li><font color="#000000">выполнять принудительную инициализацию таймеров с генерированием события обновления;</font> </li>
<li><font color="#000000">останавливать/запускать процесс счета тактовых импульсов счетным регистром (режим стробирования);</font> </li>
<li><font color="#000000">выполнять однократный запуск счета, после которого таймер будет работать непрерывно</font> </li>
</ul>
<p><font color="#0a1c1f">Для перевода таймера в подчиненный режим и выбора источника, который будет его тактировать или синхронизировать, предназначены разряды SMS (<em>Slave mode selection, т.е. выбор режима ведомого</em>) регистра SMCR <em>(Slave mode control register, т.е. управляющий регистр режима ведомого, или подчиненного).</em> </font></p>
<p><font color="#0a1c1f">В зависимости от состояния разрядов SMS таймер будет настроен следующим образом:</font></p>
<ol>
<li><strong>SMS=000</strong> – режим подчиненного отключен; если CEN=1, предварительный делитель таймера тактируется напрямую от сигнала CK_INT (источник внутреннего тактирования); </li>
<li><strong>SMS=001</strong> – режим энкодера №1; счетчик считает вверх или вниз по сигналу TI2FP2 (тактируется от него), в зависимости от уровня сигнала TI1FP1; </li>
<li><strong>SMS=010</strong> – режим энкодера №2; счетчик считает вверх или вниз по сигналу TI1FP1 (тактируется от него), в зависимости от уровня сигнала TI2FP2; </li>
<li><strong>SMS=011</strong> – режим энкодера №3; счетчик считает вверх или вниз по сигналам TI1FP1 и TI2FP2, в зависимости от уровня сигнала на другом входе; </li>
<li><strong>SMS=100</strong> – режим сброса (<em>Reset mode</em>); по активному уровню сигнала&nbsp; сигнала TRGI (источник выбирается разрядами TS), происходит сброс предварительного делителя и счетного регистра, также возможно формирование события обновления UEV; </li>
<li><strong>SMS=101</strong> – режим управления счетом (<em>Gated Mode</em>); если уровень сигнала TRGI активный, счетный регистр считает импульсы, иначе – останавливается; </li>
<li><strong>SMS=110</strong> – режим запуска таймера (Trigger Mode); по фронту сигнала TRGI, счетный регистр начинает считать импульсы, если TRGI после этого станет равен нулю, счет все равно продолжится; </li>
<li><strong>SMS=111</strong> – режим внешнего тактирования №1; источник тактового сигнала таймера – сигнал&nbsp; TRGI, источник которого выбирается разрядами TS. </li>
</ol>
<p><font color="#0a1c1f">Использование внешних источников для <strong>тактирования</strong> таймера (при SMS=111) было рассмотрено в предыдущей статье, поэтому сейчас сосредоточимся на использовании их для <strong>синхронизации</strong> работы таймеров.</font></p>
<p><font style="font-weight: bold"></font></p>
<h4 align="center"><font style="font-weight: bold">Синхронизация от внешнего сигнала</font></h4>
<p>В качестве синхронизирующего могут выступать сигналы ETR, TI1 или TI2, которые поступают с соответствующих выводов контроллера. Существует несколько режимов такой синхронизации: режим сброса, режим управления счетом, режим запуска и режим запуска с тактированием со входа ETR.</p>
<p><u>Режим сброса (Reset mode).</u></p>
<p>В этом режиме счетчик и предварительный делитель&nbsp; таймера могут быть принудительно инициализированы при возникновении события на входе запуска. Кроме того, если сброшен разряд URS регистра CR1, может генерироваться событие обновления UEV. Тогда все регистры с предварительной загрузкой (ARR, PSC и др.) будут обновлены.</p>
<p><a href="http://mycontroller.ru/wp-content/uploads/image121.png"><img title="image" style="border-top-width: 0px; display: block; border-left-width: 0px; float: none; border-bottom-width: 0px; margin-left: auto; margin-right: auto; border-right-width: 0px" height="237" alt="image" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/image_thumb122.png" width="682" border="0"></a></p>
<p>Для перевода таймера в этот режим необходимо записать “100” в разряды SMS регистра SMCR.</p>
<p>С помощью разрядов TS задается источник сигнала.</p>
<p>Приведенная ниже диаграмма, взятая из документации, иллюстрирует работу таймера в режиме Reset Mode (синхронизация от TI1, ARR=0×36):</p>
<p><a href="http://mycontroller.ru/wp-content/uploads/image122.png"><img title="image" style="border-top-width: 0px; display: block; border-left-width: 0px; float: none; border-bottom-width: 0px; margin-left: auto; margin-right: auto; border-right-width: 0px" height="176" alt="image" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/image_thumb123.png" width="594" border="0"></a> Как видно из диаграммы, по фронту сигнала TI1 с небольшой задержкой, необходимой для синхронизации внешнего сигнала с внутренней тактовой частотой, устанавливается разряд UG, который через один такт CK_PSC автоматически сбрасывается. При сбросе UG формируется сигнал, который принудительно инициализирует счетный регистр и сбрасывает счетчик предварительного делителя. Также возможно формирование&nbsp; события обновления UEV, если оно разрешено.</p>
<p><u>Режим управления счетом&nbsp; (Gated mode, или <em>режим стробирования</em>).</u></p>
<p>В этом режиме подача тактовых импульсов на вход предварительного делителя (а значит и на вход счетного регистра) зависит от уровня сигнала&nbsp; на выбранном входе контроллера. Схематично это выглядит следующим образом:</p>
<p><a href="http://mycontroller.ru/wp-content/uploads/image124.png"><img title="image" style="border-top-width: 0px; display: block; border-left-width: 0px; float: none; border-bottom-width: 0px; margin-left: auto; margin-right: auto; border-right-width: 0px" height="237" alt="image" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/image_thumb125.png" width="620" border="0"></a></p>
<p>Включается этот режим записью “101” в разряды SMS регистра SMCR.&nbsp; После его включения, тактовые импульсы (CK_PSC) будут поступать на вход предварительного делителя счетного регистра только при TRGI=1. Ниже приведена диаграмма режима Gated mode для входа TI1 (CC1P=1):</p>
<p><a href="http://mycontroller.ru/wp-content/uploads/image125.png"><img title="image" style="border-top-width: 0px; display: block; border-left-width: 0px; float: none; border-bottom-width: 0px; margin-left: auto; margin-right: auto; border-right-width: 0px" height="222" alt="image" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/image_thumb126.png" width="593" border="0"></a></p>
<p>В приведенном примере разрешение счета происходит, когда TI1=0 (а не 1). Это возможно потому, что разряд CC1P установлен в единицу, поэтому&nbsp; происходит инверсия TI1, и при TI1=0 сигнал TRGI (а именно он управляет подачей тактовых импульсов в режиме Gated mode) равен единице.</p>
<p>Примечательно, что всякий раз, когда счетчик начинает считать или останавливается, устанавливается в единицу флаг TIF.</p>
<p><u>Режим запуска (Trigger Mode).</u></p>
<p>В этом режиме счет импульсов начинается, когда происходит событие (заданное изменение уровня сигнала) на выбранном входе.</p>
<p><a href="http://mycontroller.ru/wp-content/uploads/image126.png"><img title="image" style="border-top-width: 0px; display: block; border-left-width: 0px; float: none; border-bottom-width: 0px; margin-left: auto; margin-right: auto; border-right-width: 0px" height="237" alt="image" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/image_thumb127.png" width="569" border="0"></a> Этот режим выбирается записью “110” в разряды SMS.</p>
<p><u>Режим внешнего тактирования №2 с внешним запуском</u></p>
<p>В этом режиме счетный регистр тактируется от внешнего сигнала с вывода ETR, при этом работа таймера синхронизируется от внешнего сигнала (использовать в этом режиме синхронизацию от ETR производитель не рекомендует).</p>
<p>Этот режим аналогичен описанным выше режимам, за исключением того, что тактирование счетного регистра осуществляется не от внутреннего сигнала CK_CNT, а сигналом с вывода ETR.</p>
<h3 align="center">Синхронизация от другого таймера</h3>
<p align="center">Когда один таймер сконфигурирован для работы в режиме мастера (<em>Master Mode</em>), он может сбрасывать, запускать, останавливать и тактировать другой таймер, настроенный в режим ведомого (или подчиненного,<em> Slave Mode</em>).</p>
<p align="center">Прежде чем описать работу подчиненного таймера, необходимо упомянуть о способах настройки таймера, являющегося мастером. Для управления подчиненным он формирует сигнал TRGO. Этот сигнал определяется разрядами MMS регистра CR2.</p>
<p align="center"><a href="http://mycontroller.ru/wp-content/uploads/image127.png"><img title="image" style="border-top-width: 0px; padding-right: 0px; display: block; padding-left: 0px; border-left-width: 0px; float: none; background-image: none; border-bottom-width: 0px; margin-left: auto; margin-right: auto; padding-top: 0px; border-right-width: 0px" height="334" alt="image" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/image_thumb128.png" width="493" border="0"></a></p>
<ul>
<li>MMS=000 – режим мастера “<strong>Reset”. </strong><font size="1">Сигнал TRGO формируется при установке разряда UG регистра<strong>&nbsp;</strong>EGR<em>. Этот разряд устанавливается программно или внешним сигналом. Он приводит к формированию события переполнения.</em></font> </li>
<li>MMS=001 -&nbsp; режим мастера “<strong>Enable</strong>”. Сигнал TRGO формируется при возникновении сигнала CNT_EN, который управляет таймером (разрешает/запрещает счет). </li>
<li>MMS=010 – режим мастера “<strong>Update</strong>”. Сигнал TRGO формируется при возникновении события обновления UEV. В этом режиме можно использовать таймер-мастер в качестве предварительного делителя для подчиненного таймера. </li>
<li>MMS=100…111 – режим мастера “<strong>Compare</strong>”. Сигнал TRGO формируется, при возникновении сигнала сравнения в соответствующем канале. </li>
</ul>
<p><font color="#0a1c1f">Каждый таймер может управляться одним из четырех таймеров. Это отображено в следующей таблице:</font></p>
<p><a href="http://mycontroller.ru/wp-content/uploads/image128.png"><img title="image" style="border-top-width: 0px; padding-right: 0px; display: block; padding-left: 0px; border-left-width: 0px; float: none; background-image: none; border-bottom-width: 0px; margin-left: auto; margin-right: auto; padding-top: 0px; border-right-width: 0px" height="97" alt="image" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/image_thumb129.png" width="286" border="0"></a></p>
<p><font color="#0a1c1f" size="1"><em>В этой таблице верхняя строка – это номер подчиненного таймера. Например, таймер TIM2&nbsp; может управляться TIM1, TIM8, TIM3, или TIM4, в зависимости от разрядов TS.</em></font></p>
<p><font color="#0a1c1f">Ниже приведены способы синхронизации одного таймера другим.</font></p>
<p><font color="#0a1c1f"><u>Использование одного таймера для управления тактированием&nbsp; другого (Gated Mode, или <em>режим стробирования</em>).</u></font></p>
<p><font color="#0a1c1f">Для иллюстрации работы этого режима рассмотрим пример, когда Timer 1 сигналом OC1REF управляет подачей тактовых импульсов на&nbsp; TIM2 (предполагаем, что&nbsp; оба таймера тактируются внутренним тактовым сигналом деленным предварительным делителем на 3).</font></p>
<ol>
<li>Обеспечить подачу сигнала с выхода канала сравнения №1 на выход TRGO таймера TIM1: MMS=100. </li>
<li>Настроить формирование сигнала OC1REF таймера TIM </li>
<li><font color="#0a1c1f">Подключить TIM2 к выходу TIM1 и включить режим управления тактированием: TS=000, SMS=101</font> </li>
<li>Включить TIM2: записать единицу в разряд CEN регистра TIM2_CR2 </li>
<li>Запустить TIM1: записать единицу в разряд CEN регистра TIM2_CR1 </li>
</ol>
<p><font color="#0a1c1f">Временная диаграмма выглядит следующим образом:</font></p>
<p><a href="http://mycontroller.ru/wp-content/uploads/image129.png"><img title="image" style="border-top-width: 0px; padding-right: 0px; display: block; padding-left: 0px; border-left-width: 0px; float: none; background-image: none; border-bottom-width: 0px; margin-left: auto; margin-right: auto; padding-top: 0px; border-right-width: 0px" height="169" alt="image" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/image_thumb130.png" width="450" border="0"></a></p>
<p>В этом примере счетный регистр и регистр предварительного делителя таймера TIM2 не инициализируются перед запуском, поэтому при старте они начинают считать с их текущего значения. Чтобы счет начинался с нуля, нужно сбросить оба таймера перед запуском TIM1. Также можно записать любое значение в счетные регистры таймеров или сбросить таймеры программно записав единицу в разряды UG регистров EGR обоих таймеров.</p>
<p>В следующем примере TIM1 настроен в режиме мастера, но стартовать будет с нуля. TIM2 все также подчиненный, но будет стартовать с 0xE7. Коэффициент деления предварительного делителя одинаковый в обоих таймерах. TIM2 останавливается, когда TIM1 выключен, записью нуля в CEN.</p>
<ol>
<li>Обеспечить подачу сигнала с выхода канала сравнения №1 на выход TRGO таймера TIM1: MMS=100. </li>
<li>Настроить формирование сигнала OC1REF таймера TIM1. </li>
<li><font color="#0a1c1f">Подключить TIM2 к выходу TIM1 и включить режим управления тактированием: TS=000, SMS=101</font> </li>
<li>Сбросить TIM1: записать единицу в разряд UG регистра TIM1_EGR </li>
<li>Сбросить TIM2: записать единицу в разряд UG регистра TIM2_EGR </li>
<li>Включить TIM2: записать единицу в разряд CEN регистра TIM2_CR2 </li>
<li>Запустить TIM1: записать единицу в разряд CEN регистра TIM2_CR1 </li>
<li>Остановить TIM1: записать ноль в разряд CEN регистра TIM2_CR1 </li>
</ol>
<p><a href="http://mycontroller.ru/wp-content/uploads/image130.png"><img title="image" style="border-top-width: 0px; padding-right: 0px; display: block; padding-left: 0px; border-left-width: 0px; float: none; background-image: none; border-bottom-width: 0px; margin-left: auto; margin-right: auto; padding-top: 0px; border-right-width: 0px" height="222" alt="image" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/image_thumb131.png" width="448" border="0"></a></p>
<p><u>Использование одного таймера для запуска другого (Trigger&nbsp; Mode)</u></p>
<p>В следующем примере для запуска TIM2 используется событие обновления UEV таймера TIM1. Счет таймера TIM2 начинается с произвольного значения, после формирования события обновления таймера TIM1. Когда TIM2 принимает сигнал запуска от TIM1, его разряд CEN автоматически устанавливается и счетный регистр будет считать импульсы до тех пор, пока не будет сброшен разряд CEN регистра TIM2_CR1 записью в него нуля.</p>
<ol>
<li>Обеспечить подачу сигнала UEV на выход TRGO таймера TIM1: MMS=010 </li>
<li>Задать период таймера TIM1 (значение регистра TIM1_ARR) </li>
<li><font color="#0a1c1f">Подключить TIM2 к выходу TIM1 и включить режим запуска от таймера TIM1: TS=000, SMS=110</font> </li>
<li>Запустить таймер TIM1: записать 1 в разряд CEN регистра TIM1_CR1 </li>
</ol>
<p><a href="http://mycontroller.ru/wp-content/uploads/image131.png"><img title="image" style="border-top-width: 0px; padding-right: 0px; display: block; padding-left: 0px; border-left-width: 0px; float: none; background-image: none; border-bottom-width: 0px; margin-left: auto; margin-right: auto; padding-top: 0px; border-right-width: 0px" height="192" alt="image" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/image_thumb132.png" width="448" border="0"></a></p>
<p><u>Использование одного таймера в качестве делителя для другого.</u></p>
<p>Пример настройки таймера TIM1 для работы в качестве предварительного делителя таймера TIM2:</p>
<ol>
<li>Обеспечить подачу сигнала UEV на выход TRGO таймера TIM1: MMS=010. </li>
<li>Задать период таймера TIM1 (значение регистра TIM1_ARR). </li>
<li><font color="#0a1c1f">Подключить TIM2 к выходу TIM1: TS=000.</font> </li>
<li><font color="#0a1c1f">Включить режим внешнего тактирования таймера TIM1: SMS=111.</font> </li>
<li>Включить TIM2: записать единицу в разряд CEN регистра TIM2_CR2. </li>
<li>Включить TIM1: записать единицу в разряд CEN регистра TIM1_CR2 </li>
</ol>
<p><u>Запуск одного таймера синхронно с другим</u></p>
<p>В этом режиме возможен одновременный запуск нескольких таймеров.</p>
                  
</div>
<div class="cleared"></div>
<div class="art-PostFooterIcons art-metadata-icons">
Рубрика: <a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/timer/" title="Просмотреть все записи в рубрике «TIMER»" rel="category tag">TIMER</a>, <a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/" title="Просмотреть все записи в рубрике «МИКРОКОНТРОЛЛЕРЫ STM32»" rel="category tag">МИКРОКОНТРОЛЛЕРЫ STM32</a>
</div>

</div>

		<div class="cleared"></div>
    </div>
</div>


<!-- You can start editing here. -->


			<!-- If comments are open, but there are no comments. -->

	 

<div class="art-Post">
    <div class="art-Post-tl"></div>
    <div class="art-Post-tr"></div>
    <div class="art-Post-bl"></div>
    <div class="art-Post-br"></div>
    <div class="art-Post-tc"></div>
    <div class="art-Post-bc"></div>
    <div class="art-Post-cl"></div>
    <div class="art-Post-cr"></div>
    <div class="art-Post-cc"></div>
    <div class="art-Post-body">
<div class="art-Post-inner art-article">

<div class="art-PostContent">

<div id="respond">
  
  <h3>Оставить комментарий</h3>

<div class="cancel-comment-reply">
	<small><a rel="nofollow" id="cancel-comment-reply-link" href="http://mycontroller.ru/stm32-timer-general-purpose-vneshnyaya-sinhronizatsiya/#respond" style="display:none;">Нажмите, чтобы отменить ответ.</a></small>
</div>


<form action="http://mycontroller.ru/wp-comments-post.php" method="post" id="commentform">


<p><input type="text" name="author" id="author" value="" size="22" tabindex="1">
<label for="author"><small>Имя </small></label></p>

<p><input type="text" name="email" id="email" value="" size="22" tabindex="2">
<label for="email"><small>E-mail (не публикуется) </small></label></p>

<p><input type="text" name="url" id="url" value="" size="22" tabindex="3">
<label for="url"><small>Web-сайт</small></label></p>


<!--<p><small><strong>XHTML:</strong> Вы можете использовать эту разметку: <code>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code lang=&quot;&quot;&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; &lt;pre lang=&quot;&quot; extra=&quot;&quot;&gt; </code></small></p>-->

<p><textarea name="comment" id="comment" cols="100%" rows="10" tabindex="4"></textarea></p>

<p>
	<span class="art-button-wrapper">
		<span class="l"> </span>
		<span class="r"> </span>
		<input class="art-button" type="submit" name="submit" tabindex="5" value="Отправить">
	</span>
<input type="hidden" name="comment_post_ID" value="2402" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p>

</form>

</div>

</div>
<div class="cleared"></div>


</div>

		<div class="cleared"></div>
    </div>
</div>


</div>
<div class="art-sidebar1">      
<div id="mycategoryorder-2" class="widget widget_mycategoryorder"><div class="art-Block">
    <div class="art-Block-body">
<div class="art-BlockHeader">
    <div class="l"></div>
    <div class="r"></div>
    <div class="art-header-tag-icon">
        <div class="t">Рубрики</div>
    </div>
</div><div class="art-BlockContent">
    <div class="art-BlockContent-tl"></div>
    <div class="art-BlockContent-tr"></div>
    <div class="art-BlockContent-bl"></div>
    <div class="art-BlockContent-br"></div>
    <div class="art-BlockContent-tc"></div>
    <div class="art-BlockContent-bc"></div>
    <div class="art-BlockContent-cl"></div>
    <div class="art-BlockContent-cr"></div>
    <div class="art-BlockContent-cc"></div>
    <div class="art-BlockContent-body">
		<ul>
			<li class="cat-item cat-item-3"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/" title="Просмотреть все записи в рубрике «МИКРОКОНТРОЛЛЕРЫ STM32»">МИКРОКОНТРОЛЛЕРЫ STM32</a>
<ul class="children">
	<li class="cat-item cat-item-7"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/bootloader/" title="Просмотреть все записи в рубрике «Bootloader»">Bootloader</a>
</li>
	<li class="cat-item cat-item-14"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/portyi-vvoda-vyivoda/" title="Просмотреть все записи в рубрике «GPIO»">GPIO</a>
</li>
	<li class="cat-item cat-item-4"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/usart/" title="Просмотреть все записи в рубрике «USART»">USART</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/dma/" title="Просмотреть все записи в рубрике «DMA»">DMA</a>
</li>
	<li class="cat-item cat-item-15"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/bkp-registryi/" title="Просмотреть все записи в рубрике «BKP»">BKP</a>
</li>
	<li class="cat-item cat-item-8"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/rtc/" title="Просмотреть все записи в рубрике «RTC»">RTC</a>
</li>
	<li class="cat-item cat-item-16"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/timer/" title="Просмотреть все записи в рубрике «TIMER»">TIMER</a>
</li>
	<li class="cat-item cat-item-21"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/spi/" title="Просмотреть все записи в рубрике «SPI»">SPI</a>
</li>
	<li class="cat-item cat-item-24"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/adc/" title="Просмотреть все записи в рубрике «ADC»">ADC</a>
</li>
	<li class="cat-item cat-item-25"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/dac/" title="Просмотреть все записи в рубрике «DAC»">DAC</a>
</li>
	<li class="cat-item cat-item-26"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/usb/" title="Просмотреть все записи в рубрике «USB»">USB</a>
</li>
</ul>
</li>
	<li class="cat-item cat-item-19"><a href="http://mycontroller.ru/category/vneshnie-ustroystva/" title="Просмотреть все записи в рубрике «ВНЕШНИЕ УСТРОЙСТВА»">ВНЕШНИЕ УСТРОЙСТВА</a>
<ul class="children">
	<li class="cat-item cat-item-23"><a href="http://mycontroller.ru/category/vneshnie-ustroystva/termodatchik-ds18b20/" title="Просмотреть все записи в рубрике «Термодатчик ds18b20»">Термодатчик ds18b20</a>
</li>
	<li class="cat-item cat-item-29"><a href="http://mycontroller.ru/category/vneshnie-ustroystva/enkoder/" title="Просмотреть все записи в рубрике «Энкодер»">Энкодер</a>
</li>
	<li class="cat-item cat-item-20"><a href="http://mycontroller.ru/category/vneshnie-ustroystva/karta-pamyati-sd/" title="Просмотреть все записи в рубрике «Карта памяти SD»">Карта памяти SD</a>
	<ul class="children">
	<li class="cat-item cat-item-31"><a href="http://mycontroller.ru/category/vneshnie-ustroystva/karta-pamyati-sd/rabota-s-ffatfs/" title="Просмотреть все записи в рубрике «Работа с FatFs»">Работа с FatFs</a>
</li>
	</ul>
</li>
</ul>
</li>
	<li class="cat-item cat-item-1"><a href="http://mycontroller.ru/category/bez-rubriki/" title="Просмотреть все записи в рубрике «МОИ ПРОЕКТЫ»">МОИ ПРОЕКТЫ</a>
<ul class="children">
	<li class="cat-item cat-item-6"><a href="http://mycontroller.ru/category/bez-rubriki/chasyi-na-stm32f100rb/" title="Просмотреть все записи в рубрике «Часы на STM32F100RB»">Часы на STM32F100RB</a>
</li>
	<li class="cat-item cat-item-28"><a href="http://mycontroller.ru/category/bez-rubriki/umnyiy-dom/" title="Просмотреть все записи в рубрике «Умный Дом»">Умный Дом</a>
</li>
	<li class="cat-item cat-item-30"><a href="http://mycontroller.ru/category/bez-rubriki/waveplayer/" title="Просмотреть все записи в рубрике «WavePlayer»">WavePlayer</a>
</li>
</ul>
</li>
	<li class="cat-item cat-item-10"><a href="http://mycontroller.ru/category/poleznyiy-soft/" title="Просмотреть все записи в рубрике «ПОЛЕЗНЫЙ СОФТ»">ПОЛЕЗНЫЙ СОФТ</a>
<ul class="children">
	<li class="cat-item cat-item-11"><a href="http://mycontroller.ru/category/poleznyiy-soft/stm32-generator-koda/" title="Просмотреть все записи в рубрике «STM32 генератор»">STM32 генератор</a>
</li>
</ul>
</li>
		</ul>
		
		<div class="cleared"></div>
    </div>
</div>

		<div class="cleared"></div>
    </div>
</div>
</div>		<div id="recent-posts-2" class="widget widget_recent_entries"><div class="art-Block">
    <div class="art-Block-body">
		<div class="art-BlockHeader">
    <div class="l"></div>
    <div class="r"></div>
    <div class="art-header-tag-icon">
        <div class="t">Свежие записи</div>
    </div>
</div><div class="art-BlockContent">
    <div class="art-BlockContent-tl"></div>
    <div class="art-BlockContent-tr"></div>
    <div class="art-BlockContent-bl"></div>
    <div class="art-BlockContent-br"></div>
    <div class="art-BlockContent-tc"></div>
    <div class="art-BlockContent-bc"></div>
    <div class="art-BlockContent-cl"></div>
    <div class="art-BlockContent-cr"></div>
    <div class="art-BlockContent-cc"></div>
    <div class="art-BlockContent-body">
		<ul>
				<li><a href="http://mycontroller.ru/stm32-generator-koda-novaya-versiya/" title="STM32 Генератор кода. Новая версия">STM32 Генератор кода. Новая версия</a></li>
				<li><a href="http://mycontroller.ru/stm32-generator-koda-konstruktor-komponentov/" title="STM32 “Конструктор компонентов” для “Генератора кода”">STM32 “Конструктор компонентов” для “Генератора кода”</a></li>
				<li><a href="http://mycontroller.ru/stm32-vosproizvedenie-zvuka-rasshirenie-vozmozhnostey-programmyi/" title="STM32 Воспроизведение звука. Расширение возможностей программы">STM32 Воспроизведение звука. Расширение возможностей программы</a></li>
				<li><a href="http://mycontroller.ru/stm32-vosproizvedenie-zvuka-nastroyka-dac/" title="STM32 Воспроизведение звука. Настройка периферии + первый звук">STM32 Воспроизведение звука. Настройка периферии + первый звук</a></li>
				<li><a href="http://mycontroller.ru/stm32-dac-primeryi-ispolzovaniya/" title="STM32 DAC Примеры использования">STM32 DAC Примеры использования</a></li>
				</ul>
		
		<div class="cleared"></div>
    </div>
</div>

		<div class="cleared"></div>
    </div>
</div>
</div><div id="text-5" class="widget widget_text"><div class="art-Block">
    <div class="art-Block-body">
<div class="art-BlockHeader">
    <div class="l"></div>
    <div class="r"></div>
    <div class="art-header-tag-icon">
        <div class="t">Немного рекламы</div>
    </div>
</div><div class="art-BlockContent">
    <div class="art-BlockContent-tl"></div>
    <div class="art-BlockContent-tr"></div>
    <div class="art-BlockContent-bl"></div>
    <div class="art-BlockContent-br"></div>
    <div class="art-BlockContent-tc"></div>
    <div class="art-BlockContent-bc"></div>
    <div class="art-BlockContent-cl"></div>
    <div class="art-BlockContent-cr"></div>
    <div class="art-BlockContent-cc"></div>
    <div class="art-BlockContent-body">
			<div class="textwidget"><script type="text/javascript"><!--
google_ad_client = "ca-pub-6213925206017237";
/* second */
google_ad_slot = "7273021636";
google_ad_width = 200;
google_ad_height = 200;
//-->
</script>
<script type="text/javascript" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/show_ads.js">
</script><ins style="display:inline-table;border:none;height:200px;margin:0;padding:0;position:relative;visibility:visible;width:200px"><ins id="aswift_0_anchor" style="display:block;border:none;height:200px;margin:0;padding:0;position:relative;visibility:visible;width:200px"><iframe allowtransparency="true" frameborder="0" height="200" hspace="0" marginwidth="0" marginheight="0" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){w.location.replace(h)}}" scrolling="no" vspace="0" width="200" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;"></iframe></ins></ins></div>
		
		<div class="cleared"></div>
    </div>
</div>

		<div class="cleared"></div>
    </div>
</div>
</div>

<p align="center">

</p>

</div>
</div>
<div class="cleared"></div>

<div class="art-Footer">
    <div class="art-Footer-inner">
                <div class="art-Footer-text">
<p>
<a href="http://mycontroller.ru/stm32-timer-general-purpose-vneshnyaya-sinhronizatsiya/#">Contact Us</a> | <a href="http://mycontroller.ru/stm32-timer-general-purpose-vneshnyaya-sinhronizatsiya/#">Terms of Use</a> | <a href="http://mycontroller.ru/stm32-timer-general-purpose-vneshnyaya-sinhronizatsiya/#">Trademarks</a> | <a href="http://mycontroller.ru/stm32-timer-general-purpose-vneshnyaya-sinhronizatsiya/#">Privacy Statement</a><br>Copyright © 2009 My Controller. All Rights Reserved.</p>
</div>
    </div>
    <div class="art-Footer-background">
    </div>
</div>

		<div class="cleared"></div>
    </div>
</div>
<div class="cleared"></div>
<p class="art-page-footer">Powered by <a href="http://wordpress.org/">WordPress</a> and <a href="http://www.artisteer.com/?p=wordpress_themes">WordPress Theme</a> created with Artisteer.</p>
</div>

<!-- 23 запросов. 0,282 секунд. -->
<div>
<!-- SyntaxHighlighter Stuff -->
<script type="text/javascript" src="./STM32 TIMER. general purpose. Внешняя синхронизация_files/shCore.js"></script>
<script type="text/javascript">
	SyntaxHighlighter.all();
</script>

</div>


</body></html>