<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0051)http://mycontroller.ru/usart-naznachenie-registrov/ -->
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="ru-RU" class="chrome  win"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
<title>STM32 USART. Назначение регистров</title>
<script type="text/javascript" src="./STM32 USART. Назначение регистров_files/script.js"></script>
<link rel="stylesheet" href="./STM32 USART. Назначение регистров_files/style.css" type="text/css" media="screen">
<!--[if IE 6]><link rel="stylesheet" href="http://mycontroller.ru/wp-content/themes/MyController/style.ie6.css" type="text/css" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="http://mycontroller.ru/wp-content/themes/MyController/style.ie7.css" type="text/css" media="screen" /><![endif]-->
<link rel="alternate" type="application/rss+xml" title="RSS-лента My Controller" href="http://mycontroller.ru/feed/">
<link rel="alternate" type="application/atom+xml" title="Atom-лента My Controller" href="http://mycontroller.ru/feed/atom/"> 
<link rel="pingback" href="http://mycontroller.ru/xmlrpc.php">
<link rel="alternate" type="application/rss+xml" title="My Controller » Лента комментариев к «STM32 USART. Назначение регистров»" href="http://mycontroller.ru/usart-naznachenie-registrov/feed/">
<link rel="stylesheet" id="msw_wpfm_scan-css" href="./STM32 USART. Назначение регистров_files/wordpress-file-monitor.php" type="text/css" media="all">
<link rel="stylesheet" id="bwp-syntax-css" href="./STM32 USART. Назначение регистров_files/bwp-syntax.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-downloadmanager-css" href="./STM32 USART. Назначение регистров_files/download-css.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-pagenavi-css" href="./STM32 USART. Назначение регистров_files/pagenavi-css.css" type="text/css" media="all">
<script type="text/javascript" src="./STM32 USART. Назначение регистров_files/jquery.js"></script>
<script type="text/javascript" src="./STM32 USART. Назначение регистров_files/bwp-syntax.js"></script>
<script type="text/javascript" src="./STM32 USART. Назначение регистров_files/external-tracking.min.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://mycontroller.ru/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://mycontroller.ru/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="STM32 USART. Введение" href="http://mycontroller.ru/stm32-usart-vvedenie/">
<link rel="next" title="STM32 USART. Инициализация модуля" href="http://mycontroller.ru/usart-initsializatsiya-modulya/">
<meta name="generator" content="WordPress 3.3.1">
<link rel="canonical" href="./STM32 USART. Назначение регистров_files/STM32 USART. Назначение регистров.htm">
<link rel="shortlink" href="http://mycontroller.ru/?p=17">

<link rel="stylesheet" href="./STM32 USART. Назначение регистров_files/wp-syntax.css" type="text/css" media="screen">
<!-- wpSpoiler Code -->
        <script type="text/javascript">
            function wpSpoilerToggle(spoiler, link, showtext, hidetext) {
                if (spoiler.style.display != 'none') {
                    spoiler.style.display = 'none';
                    link.innerHTML = showtext;
                    link.className = 'spoiler_link_show';
                } else {
                    spoiler.style.display = 'block';
                    link.innerHTML = hidetext;
                    link.className = 'spoiler_link_hide';
                }
            }
          </script>
	<link type="text/css" rel="stylesheet" href="./STM32 USART. Назначение регистров_files/shCore.css">
	<link type="text/css" rel="stylesheet" href="./STM32 USART. Назначение регистров_files/shThemeDefault.css">
<!-- Google Analytics Tracking by Google Analyticator 6.0.2: http://ronaldheft.com/code/analyticator/ -->
<script type="text/javascript">window.google_analytics_uacct = "UA-29082067-1";</script>
<script type="text/javascript">
	var analyticsFileTypes = [''];
	var analyticsEventTracking = 'enabled';
</script>
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-29082067-1']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script><script type="text/javascript" async="" src="./STM32 USART. Назначение регистров_files/ga.js"></script>
</head>
<body>
<div id="art-page-background-simple-gradient">
</div>
<div id="art-main">
<div class="art-Sheet">
    <div class="art-Sheet-tl"></div>
    <div class="art-Sheet-tr"></div>
    <div class="art-Sheet-bl"></div>
    <div class="art-Sheet-br"></div>
    <div class="art-Sheet-tc"></div>
    <div class="art-Sheet-bc"></div>
    <div class="art-Sheet-cl"></div>
    <div class="art-Sheet-cr"></div>
    <div class="art-Sheet-cc"></div>
    <div class="art-Sheet-body">
<div class="art-Header">
    <div class="art-Header-png"></div>
    <div class="art-Header-jpeg"></div>
<div class="art-Logo">
    <h1 id="name-text" class="art-Logo-name">
        <a href="http://mycontroller.ru/">My Controller</a></h1>
    <div id="slogan-text" class="art-Logo-text">
        Изучаем микроконтроллеры STM32</div>
</div>

</div>
<div class="art-nav">
	<div class="l"></div>
	<div class="r"></div>
	<ul class="art-menu">
		<li><a href="http://mycontroller.ru/"><span class="l"></span><span class="r"></span><span class="t">Home</span></a></li><li><span class="art-menu-separator"></span></li><li class="page_item page-item-10"><a href="http://mycontroller.ru/o-sayte/"><span class="l"></span><span class="r"></span><span class="t">О сайте</span></a></li><li><span class="art-menu-separator"></span></li>
<li class="page_item page-item-186"><a href="http://mycontroller.ru/programmyi/"><span class="l"></span><span class="r"></span><span class="t">СОФТ</span></a></li>
	</ul>
</div>
<div class="art-contentLayout">
<div class="art-content">

<div class="art-Post">
    <div class="art-Post-tl"></div>
    <div class="art-Post-tr"></div>
    <div class="art-Post-bl"></div>
    <div class="art-Post-br"></div>
    <div class="art-Post-tc"></div>
    <div class="art-Post-bc"></div>
    <div class="art-Post-cl"></div>
    <div class="art-Post-cr"></div>
    <div class="art-Post-cc"></div>
    <div class="art-Post-body">
<div class="art-Post-inner art-article">

<div class="art-PostContent">

<div class="navigation">
	<div class="alignleft">« <a href="http://mycontroller.ru/stm32-usart-vvedenie/" rel="prev">STM32 USART. Введение</a></div>
	<div class="alignright"><a href="http://mycontroller.ru/usart-initsializatsiya-modulya/" rel="next">STM32 USART. Инициализация модуля</a> »</div>
</div>

</div>
<div class="cleared"></div>


</div>

		<div class="cleared"></div>
    </div>
</div>

<div class="art-Post">
    <div class="art-Post-tl"></div>
    <div class="art-Post-tr"></div>
    <div class="art-Post-bl"></div>
    <div class="art-Post-br"></div>
    <div class="art-Post-tc"></div>
    <div class="art-Post-bc"></div>
    <div class="art-Post-cl"></div>
    <div class="art-Post-cr"></div>
    <div class="art-Post-cc"></div>
    <div class="art-Post-body">
<div class="art-Post-inner art-article">
<h2 class="art-PostHeader">
<a href="./STM32 USART. Назначение регистров_files/STM32 USART. Назначение регистров.htm" rel="bookmark" title="Постоянная ссылка на STM32 USART. Назначение регистров">
STM32 USART. Назначение регистров</a>
</h2>
<div class="art-PostContent">

          <p>В контроллерах STM32 для настройки каждого модуля USART и работы с ними имеется по 7 регистров:</p>
<ol>
<li><strong>USART_SR</strong> регистр статуса — содержит флаги, указывающие на состояние модуля;</li>
<li><strong>USART_DR</strong> регистр данных — в него пишем передаваемые данные и читаем принятые;</li>
<li><strong>USART_BRR </strong> регистр, определяющий скорость обмена;</li>
<li><strong>USART_CR1</strong> управляющий регистр 1;</li>
<li><strong>USART_CR2 </strong> управляющий регистр 2;</li>
<li><strong>USART_CR3</strong> управляющий регистр 3;</li>
<li><strong>USART_GTPR</strong> регистр делителя и задержки.</li>
</ol>
<p>Регистров много, но пугаться не надо. Мы начнем с рассмотрения тех регистров и тех разрядов,которые необходимы для обеспечения асинхронного обмена с ПК или другим контроллером.<br>
<span id="more-17"></span></p>
<p>Начнем с регистра статуса <strong>USART_SR</strong>. В нем находятся флаги, указывающие на текущее состояние модуля. Анализируя их, ЦПУ должен соотвественно реагировать. Всего имеется 10 флагов, но мы обратим внимание на 6:</p>
<ul>
<li>PE (разряд 0) — ошибка паритета при приеме байта. Можно задавать четное или нечетное число единиц в принимаемом байте. Если приняли байт, а в нем другое количество единиц, значит имеем ошибку (аппаратная проверка на ошибки). Весьма интересный флаг, но я его никогда не использовал (консервативность, что ли?).</li>
<li>FE (разряд 1) — ошибка кадра при приеме байта, т.е. первый стоп-бит принятой посылки равен «0″.</li>
<li>NE (разряд 2) — флаг наличия шума.&nbsp;Ставится аппаратно, когда обнаружен шум в принимаемом кадре.</li>
</ul>
<p>Перечисленные выше флаги позволяют определить, что имеет место ошибка при приеме байта (говорю байт, хотя передаваемая посылка может иметь разрядность отличную от 8).<br>
Очищаются они программно, последовательностью операций чтения регистра USART_SR, с последующим чтением регистра USART_DR.</p>
<p>Следующая группа флагов позволяет определить окончание передачи или приема данных:</p>
<ul>
<li>RXNE (разряд 5) — в регистре данных приема есть данные, т.е. принят байт данных, нужно срочно что-то делать. Если в USART_CR1 бит &nbsp;RXNEIE=1, то генерируется прерывание. Этот бит очищается чтением регистра USART_DR (это согласно описанию, но у меня он очищался только записью в него нуля :roll: ).</li>
<li>TC (разряд 6) — передача завершена. Если регистр передачи данных пуст (на что указывает флаг TXE регистра USART_SR) и в USART_CR1 бит TCIE=1, то генерируется прерывание.Очищается чтением USART_SR с последующей записью в USART_DR.</li>
<li>TXE (разряд 7) — регистр данных передачи пуст. Очищается программно, записью в регистр USART_DR новых данных.</li>
</ul>
<p><em>В чем отличие TXE от TC ?</em><br>
<em>USART передает данные из сдвигового регистра. А в этот сдвиговый регистр они попадают из регистра DR: процессор записывает данные в DR и в нем они будут находиться&nbsp; пока сдвиговый регистр не освободится. Как только он освободится (данные будут переданы) информация из DR будет переписана в него и будет установлен флаг </em><em>TXE</em><em> (регистр данных пуст). Если процессор на это никак не отреагирует, то по освобождению сдвигового регистра будет установлен также флаг </em><em>TC</em><em>.</em></p>
<p>Регистр <em> </em><strong>USART_DR </strong>содержит байт принятых или передаваемых данных. Хотя в программе обращение происходит как бы к одному регистру, на самом деле он состоит из двух &nbsp;- при чтении информация поступает из регистра приемника модуля, а при записи данные заносятся в регистр передатчика.<br>
Для работы с регистром&nbsp; данных используется следующая конструкция:<br>
<code>USART1-&gt;DR = data; &nbsp; &nbsp; &nbsp; //передать байт<br>
tmp = USART1-&gt;DR; &nbsp; &nbsp; &nbsp; &nbsp;//прочитать принятый байт</code></p>
<p>Регистр <strong>USART_BRR</strong> определяет скорость обмена. Он немножко сложновастенький. Содержит переменную, определяющую скорость обмена. Эта переменная состоит из двух частей — основной и дробной. Благодаря дробной части можно весьма точно отстроить скорость обмена независимо от частоты тактового сигнала.<br>
Скорость обмена вычисляется по формуле:</p>
<p>baud = fck / (16*USARTDIV)<br>
где fck — входной тактовый сигнал (PCLK1 для USART2, 3 &nbsp;и PCLK2 для USART1);<br>
USARTDIV — число с фиксированной точкой, которым закодирован регистр USART_BRR.</p>
<p>Сответственно USARTDIV = fck / (16*baud)</p>
<p>Если нужна скорость 9600 при fck=8MHz : USARTDIV = 8000000/(16*9600)=52,0833</p>
<p>Округляем до двух разрядов после запятой и получаем&nbsp;USARTDIV =52,08</p>
<p>Что же загрузить в <strong>USART_BRR</strong>? Обратим внимание на его структуру:</p>
<ul>
<li>разряды 0..3 — DIV_Fraction, или дробная часть;</li>
<li>разряды 4..15 — DIV_Mantissa, или основная часть.</li>
</ul>
<p>Не спешите записывать &nbsp;08 в DIV_Fraction.</p>
<p>08 (т.е. полученный остаток) необходимо умножить на 16.</p>
<p>0.08 * 16 = &nbsp;1.28 -&gt; окрулив до ближайшего целого числа получим&nbsp;DIV_Fraction = 0×01 (если бы получили 10, то в шестнадцатеричной системе имели бы ox0A).</p>
<p>Преобразовав основную часть в hex, имеем &nbsp;DIV_Mantissa = 0d52 = 0×34.</p>
<p>И, наконец, имеем значение регистра скорости передачи :&nbsp;USART_BRR = 0×0341.<br>
Для записи в реальный регистр используется следующая запись:</p>
<p><code>USART1-&gt;BRR = 0x0341 &nbsp; &nbsp; //записать значение скорости в&nbsp;BRR модуля&nbsp;USART1</code></p>
<p>Есть одна маленькая загвоздочка — мы выполнили округление : было &nbsp;52,08(3), а получили 52,08.<br>
Какая погрешность? Вычислим ее. Для этого необходимо преобразовать полученное значение USART_BRR в &nbsp;USARTDIV:</p>
<p>целая часть = 0×34 = 0d52, &nbsp;дробная часть = 1/16 = 0.0625, USARTDIV = 52.0625 вместо первоначальных 52,0833.</p>
<p>Посчитаем ошибку настройки в процентах :</p>
<p>error = &nbsp;100% -&nbsp;52.0625*100 / 52,0833 = 0.04%.<br>
Если я не ошибаюсь, ошибка вполне приемлемая.</p>
<p>Да, чуть не забыл. Если в результате вычислений получили DIV_Fraction &nbsp;после округлений равен 16,<br>
то необходимо выполнить перенос единицы в основную часть.</p>
<p>Постараюсь позже написать утилитку, которая вычисляет значение USART_BRR по заданным fck и baud. :-)</p>
<p>Дальше рассмотрим три управляющих регистра -&nbsp;<strong>USART_CR1</strong>,&nbsp;<strong>USART_CR2,&nbsp;<strong>USART_CR3.</strong></strong><br>
Рассматривать будем только необходимые для нашей задачи разряды.</p>
<p>Регистр &nbsp;<strong>USART_CR1:</strong></p>
<ul>
<li>UE (разряд 13) разрешение работы USART : 1 — работает; 0 — не работает;</li>
<li>M &nbsp;(разряд 12) длина слова: 0 — 8 бит данных; 1 — 9 бит данных;</li>
<li>PCE (разряд 10) разрешение контроля паритета: 0 — отключен; 1 -включен;</li>
<li>PS (разряд 9) тип паритета: 0 — четный; 1 — нечетный;</li>
<li>PEIE (8 разряд) разрешение прерывания при обнаружении ошибки паритета;</li>
<li>TXEIE (разряд 7)&nbsp;разрешение прерывания от TXE (когда регистр передачи пуст);</li>
<li>RXNEIE&nbsp;(разряд 6)&nbsp;разрешение прерывания от RXNE (в регистр данных перемещен принятый байт);</li>
<li>TE (разряд 3) разрешить работу&nbsp; передатчика;</li>
<li>RE (разряд 2) разрешить работу&nbsp; приемника;</li>
</ul>
<p>Регистр &nbsp;<strong>USART_CR2:</strong></p>
<p><strong> </strong>STOP(разряды 13,12) формат стоп-битов:&nbsp;00 — стоп-бит, 01 — 0.5&nbsp;стоп-бита, 10 -&nbsp; 2&nbsp;стоп-бита, 11 — 1.5&nbsp;стоп-бита;</p>
<p>Регистр &nbsp;<strong>USART_CR3:</strong></p>
<ul>
<li>DMAT&nbsp;(разряд 7) разрешить работу передатчика через DMA;</li>
<li>DMAR (разряд 6) разрешить работу приемника через DMA;</li>
</ul>
<p>На этом пока закончим рассматривать регистры.</p>
<p>Продолжим изучение усарта с рассмотрения примеров инициализации.</p>
                  
</div>
<div class="cleared"></div>
<div class="art-PostFooterIcons art-metadata-icons">
Рубрика: <a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/usart/" title="Просмотреть все записи в рубрике «USART»" rel="category tag">USART</a>, <a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/" title="Просмотреть все записи в рубрике «МИКРОКОНТРОЛЛЕРЫ STM32»" rel="category tag">МИКРОКОНТРОЛЛЕРЫ STM32</a> | Метки: <a href="http://mycontroller.ru/tag/usart_brr/" rel="tag">USART_BRR</a> 
</div>

</div>

		<div class="cleared"></div>
    </div>
</div>


<!-- You can start editing here. -->


<div class="art-Post">
    <div class="art-Post-tl"></div>
    <div class="art-Post-tr"></div>
    <div class="art-Post-bl"></div>
    <div class="art-Post-br"></div>
    <div class="art-Post-tc"></div>
    <div class="art-Post-bc"></div>
    <div class="art-Post-cl"></div>
    <div class="art-Post-cr"></div>
    <div class="art-Post-cc"></div>
    <div class="art-Post-body">
<div class="art-Post-inner art-article">

<div class="art-PostContent">

<h3 id="comments">Комментарии (9) на “STM32 USART. Назначение регистров”</h3>



</div>
<div class="cleared"></div>


</div>

		<div class="cleared"></div>
    </div>
</div>


	<ul class="commentlist">
       <li class="comment even thread-even depth-1" id="li-comment-4">
     <div id="comment-4">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">Владимир:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/usart-naznachenie-registrov/#comment-4">26.01.2012 в 11:04</a></div>

      <p>Маленький вопросик.<br>
Цитата:<br>
«Если в результате вычислений получили DIV_Fraction  после округлений равен 16,<br>
 то необходимо выполнить перенос единицы в основную часть.»</p>
<p>Как DIV_Fraction может быть равен 16, если мы его получаем путём умножения 16 на число ВСЕГДА меньшее единицы?</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/usart-naznachenie-registrov/?replytocom=4#respond" onclick="return addComment.moveForm(&quot;comment-4&quot;, &quot;4&quot;, &quot;respond&quot;, &quot;17&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
</li>
   <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-5">
     <div id="comment-5">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">Владимир:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/usart-naznachenie-registrov/#comment-5">26.01.2012 в 11:07</a></div>

      <p>Отзываю свой комментарий — имеются ввиду случаи типа 15,9</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/usart-naznachenie-registrov/?replytocom=5#respond" onclick="return addComment.moveForm(&quot;comment-5&quot;, &quot;5&quot;, &quot;respond&quot;, &quot;17&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
</li>
   <li class="comment byuser comment-author-admin bypostauthor even thread-even depth-1" id="li-comment-7">
     <div id="comment-7">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">admin:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/usart-naznachenie-registrov/#comment-7">27.01.2012 в 08:24</a></div>

      <p>Необходимо выполнять округление до ближайшего целого числа, поэтому возможно получение значение  равное 16.</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/usart-naznachenie-registrov/?replytocom=7#respond" onclick="return addComment.moveForm(&quot;comment-7&quot;, &quot;7&quot;, &quot;respond&quot;, &quot;17&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
</li>
   <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-172">
     <div id="comment-172">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">Федор:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/usart-naznachenie-registrov/#comment-172">18.03.2012 в 19:30</a></div>

      <p>Все считается гораздо проще — (fck+baudrate/2)/baudrate на выходе получаем нужное значение BRR, без всяких сложных округлений и тп. При этом все деления цельночисленные.</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/usart-naznachenie-registrov/?replytocom=172#respond" onclick="return addComment.moveForm(&quot;comment-172&quot;, &quot;172&quot;, &quot;respond&quot;, &quot;17&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
</li>
   <li class="comment even thread-even depth-1" id="li-comment-277">
     <div id="comment-277">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">Роман:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/usart-naznachenie-registrov/#comment-277">25.04.2012 в 11:28</a></div>

      <p>Еще проще воспользоваться библиотекой: <a href="http://www.st.com/internet/com/SOFTWARE_RESOURCES/SW_COMPONENT/FIRMWARE/stm32f10x_stdperiph_lib.zip" rel="nofollow">http://www.st.com/internet/com/SOFTWARE_RESOURCES/SW_COMPONENT/FIRMWARE/stm32f10x_stdperiph_lib.zip</a></p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/usart-naznachenie-registrov/?replytocom=277#respond" onclick="return addComment.moveForm(&quot;comment-277&quot;, &quot;277&quot;, &quot;respond&quot;, &quot;17&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
<ul class="children">
   <li class="comment odd alt depth-2" id="li-comment-1371">
     <div id="comment-1371">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">craftmail:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/usart-naznachenie-registrov/#comment-1371">02.10.2012 в 23:42</a></div>

      <p>Называется- копай,бабушка…..</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/usart-naznachenie-registrov/?replytocom=1371#respond" onclick="return addComment.moveForm(&quot;comment-1371&quot;, &quot;1371&quot;, &quot;respond&quot;, &quot;17&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
</li>
</ul>
</li>
   <li class="comment even thread-odd thread-alt depth-1" id="li-comment-1073">
     <div id="comment-1073">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">Саша:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/usart-naznachenie-registrov/#comment-1073">04.09.2012 в 21:32</a></div>

      <p>Приветствую!</p>
<p>Довольно понятно все описано,<br>
но в описании неточность — не паритет а проверка на четность(либо нечетность) parity можно было в лоб перевести как парность.</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/usart-naznachenie-registrov/?replytocom=1073#respond" onclick="return addComment.moveForm(&quot;comment-1073&quot;, &quot;1073&quot;, &quot;respond&quot;, &quot;17&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
<ul class="children">
   <li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-1074">
     <div id="comment-1074">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">kontroller:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/usart-naznachenie-registrov/#comment-1074">04.09.2012 в 21:43</a></div>

      <p>Исправлю</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/usart-naznachenie-registrov/?replytocom=1074#respond" onclick="return addComment.moveForm(&quot;comment-1074&quot;, &quot;1074&quot;, &quot;respond&quot;, &quot;17&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
</li>
</ul>
</li>
   <li class="comment even thread-even depth-1" id="li-comment-1406">
     <div id="comment-1406">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">Андрей:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/usart-naznachenie-registrov/#comment-1406">05.10.2012 в 12:19</a></div>

      <p>Отличная статья очень помогла, но вопрос в том что содержимое регистра скорости можно вычислить попроще BRR=fck/boud; Получим то же самое!</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/usart-naznachenie-registrov/?replytocom=1406#respond" onclick="return addComment.moveForm(&quot;comment-1406&quot;, &quot;1406&quot;, &quot;respond&quot;, &quot;17&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
</li>
  </ul>


 

<div class="art-Post">
    <div class="art-Post-tl"></div>
    <div class="art-Post-tr"></div>
    <div class="art-Post-bl"></div>
    <div class="art-Post-br"></div>
    <div class="art-Post-tc"></div>
    <div class="art-Post-bc"></div>
    <div class="art-Post-cl"></div>
    <div class="art-Post-cr"></div>
    <div class="art-Post-cc"></div>
    <div class="art-Post-body">
<div class="art-Post-inner art-article">

<div class="art-PostContent">

<div id="respond">
  
  <h3>Оставить комментарий</h3>

<div class="cancel-comment-reply">
	<small><a rel="nofollow" id="cancel-comment-reply-link" href="http://mycontroller.ru/usart-naznachenie-registrov/#respond" style="display:none;">Нажмите, чтобы отменить ответ.</a></small>
</div>


<form action="http://mycontroller.ru/wp-comments-post.php" method="post" id="commentform">


<p><input type="text" name="author" id="author" value="" size="22" tabindex="1">
<label for="author"><small>Имя </small></label></p>

<p><input type="text" name="email" id="email" value="" size="22" tabindex="2">
<label for="email"><small>E-mail (не публикуется) </small></label></p>

<p><input type="text" name="url" id="url" value="" size="22" tabindex="3">
<label for="url"><small>Web-сайт</small></label></p>


<!--<p><small><strong>XHTML:</strong> Вы можете использовать эту разметку: <code>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code lang=&quot;&quot;&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; &lt;pre lang=&quot;&quot; extra=&quot;&quot;&gt; </code></small></p>-->

<p><textarea name="comment" id="comment" cols="100%" rows="10" tabindex="4"></textarea></p>

<p>
	<span class="art-button-wrapper">
		<span class="l"> </span>
		<span class="r"> </span>
		<input class="art-button" type="submit" name="submit" tabindex="5" value="Отправить">
	</span>
<input type="hidden" name="comment_post_ID" value="17" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p>

</form>

</div>

</div>
<div class="cleared"></div>


</div>

		<div class="cleared"></div>
    </div>
</div>


</div>
<div class="art-sidebar1">      
<div id="mycategoryorder-2" class="widget widget_mycategoryorder"><div class="art-Block">
    <div class="art-Block-body">
<div class="art-BlockHeader">
    <div class="l"></div>
    <div class="r"></div>
    <div class="art-header-tag-icon">
        <div class="t">Рубрики</div>
    </div>
</div><div class="art-BlockContent">
    <div class="art-BlockContent-tl"></div>
    <div class="art-BlockContent-tr"></div>
    <div class="art-BlockContent-bl"></div>
    <div class="art-BlockContent-br"></div>
    <div class="art-BlockContent-tc"></div>
    <div class="art-BlockContent-bc"></div>
    <div class="art-BlockContent-cl"></div>
    <div class="art-BlockContent-cr"></div>
    <div class="art-BlockContent-cc"></div>
    <div class="art-BlockContent-body">
		<ul>
			<li class="cat-item cat-item-3"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/" title="Просмотреть все записи в рубрике «МИКРОКОНТРОЛЛЕРЫ STM32»">МИКРОКОНТРОЛЛЕРЫ STM32</a>
<ul class="children">
	<li class="cat-item cat-item-7"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/bootloader/" title="Просмотреть все записи в рубрике «Bootloader»">Bootloader</a>
</li>
	<li class="cat-item cat-item-14"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/portyi-vvoda-vyivoda/" title="Просмотреть все записи в рубрике «GPIO»">GPIO</a>
</li>
	<li class="cat-item cat-item-4"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/usart/" title="Просмотреть все записи в рубрике «USART»">USART</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/dma/" title="Просмотреть все записи в рубрике «DMA»">DMA</a>
</li>
	<li class="cat-item cat-item-15"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/bkp-registryi/" title="Просмотреть все записи в рубрике «BKP»">BKP</a>
</li>
	<li class="cat-item cat-item-8"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/rtc/" title="Просмотреть все записи в рубрике «RTC»">RTC</a>
</li>
	<li class="cat-item cat-item-16"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/timer/" title="Просмотреть все записи в рубрике «TIMER»">TIMER</a>
</li>
	<li class="cat-item cat-item-21"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/spi/" title="Просмотреть все записи в рубрике «SPI»">SPI</a>
</li>
	<li class="cat-item cat-item-24"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/adc/" title="Просмотреть все записи в рубрике «ADC»">ADC</a>
</li>
	<li class="cat-item cat-item-25"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/dac/" title="Просмотреть все записи в рубрике «DAC»">DAC</a>
</li>
	<li class="cat-item cat-item-26"><a href="http://mycontroller.ru/category/mikrokontrolleryi-stm32/usb/" title="Просмотреть все записи в рубрике «USB»">USB</a>
</li>
</ul>
</li>
	<li class="cat-item cat-item-19"><a href="http://mycontroller.ru/category/vneshnie-ustroystva/" title="Просмотреть все записи в рубрике «ВНЕШНИЕ УСТРОЙСТВА»">ВНЕШНИЕ УСТРОЙСТВА</a>
<ul class="children">
	<li class="cat-item cat-item-23"><a href="http://mycontroller.ru/category/vneshnie-ustroystva/termodatchik-ds18b20/" title="Просмотреть все записи в рубрике «Термодатчик ds18b20»">Термодатчик ds18b20</a>
</li>
	<li class="cat-item cat-item-29"><a href="http://mycontroller.ru/category/vneshnie-ustroystva/enkoder/" title="Просмотреть все записи в рубрике «Энкодер»">Энкодер</a>
</li>
	<li class="cat-item cat-item-20"><a href="http://mycontroller.ru/category/vneshnie-ustroystva/karta-pamyati-sd/" title="Просмотреть все записи в рубрике «Карта памяти SD»">Карта памяти SD</a>
	<ul class="children">
	<li class="cat-item cat-item-31"><a href="http://mycontroller.ru/category/vneshnie-ustroystva/karta-pamyati-sd/rabota-s-ffatfs/" title="Просмотреть все записи в рубрике «Работа с FatFs»">Работа с FatFs</a>
</li>
	</ul>
</li>
</ul>
</li>
	<li class="cat-item cat-item-1"><a href="http://mycontroller.ru/category/bez-rubriki/" title="Просмотреть все записи в рубрике «МОИ ПРОЕКТЫ»">МОИ ПРОЕКТЫ</a>
<ul class="children">
	<li class="cat-item cat-item-6"><a href="http://mycontroller.ru/category/bez-rubriki/chasyi-na-stm32f100rb/" title="Просмотреть все записи в рубрике «Часы на STM32F100RB»">Часы на STM32F100RB</a>
</li>
	<li class="cat-item cat-item-28"><a href="http://mycontroller.ru/category/bez-rubriki/umnyiy-dom/" title="Просмотреть все записи в рубрике «Умный Дом»">Умный Дом</a>
</li>
	<li class="cat-item cat-item-30"><a href="http://mycontroller.ru/category/bez-rubriki/waveplayer/" title="Просмотреть все записи в рубрике «WavePlayer»">WavePlayer</a>
</li>
</ul>
</li>
	<li class="cat-item cat-item-10"><a href="http://mycontroller.ru/category/poleznyiy-soft/" title="Просмотреть все записи в рубрике «ПОЛЕЗНЫЙ СОФТ»">ПОЛЕЗНЫЙ СОФТ</a>
<ul class="children">
	<li class="cat-item cat-item-11"><a href="http://mycontroller.ru/category/poleznyiy-soft/stm32-generator-koda/" title="Просмотреть все записи в рубрике «STM32 генератор»">STM32 генератор</a>
</li>
</ul>
</li>
		</ul>
		
		<div class="cleared"></div>
    </div>
</div>

		<div class="cleared"></div>
    </div>
</div>
</div>		<div id="recent-posts-2" class="widget widget_recent_entries"><div class="art-Block">
    <div class="art-Block-body">
		<div class="art-BlockHeader">
    <div class="l"></div>
    <div class="r"></div>
    <div class="art-header-tag-icon">
        <div class="t">Свежие записи</div>
    </div>
</div><div class="art-BlockContent">
    <div class="art-BlockContent-tl"></div>
    <div class="art-BlockContent-tr"></div>
    <div class="art-BlockContent-bl"></div>
    <div class="art-BlockContent-br"></div>
    <div class="art-BlockContent-tc"></div>
    <div class="art-BlockContent-bc"></div>
    <div class="art-BlockContent-cl"></div>
    <div class="art-BlockContent-cr"></div>
    <div class="art-BlockContent-cc"></div>
    <div class="art-BlockContent-body">
		<ul>
				<li><a href="http://mycontroller.ru/stm32-generator-koda-novaya-versiya/" title="STM32 Генератор кода. Новая версия">STM32 Генератор кода. Новая версия</a></li>
				<li><a href="http://mycontroller.ru/stm32-generator-koda-konstruktor-komponentov/" title="STM32 “Конструктор компонентов” для “Генератора кода”">STM32 “Конструктор компонентов” для “Генератора кода”</a></li>
				<li><a href="http://mycontroller.ru/stm32-vosproizvedenie-zvuka-rasshirenie-vozmozhnostey-programmyi/" title="STM32 Воспроизведение звука. Расширение возможностей программы">STM32 Воспроизведение звука. Расширение возможностей программы</a></li>
				<li><a href="http://mycontroller.ru/stm32-vosproizvedenie-zvuka-nastroyka-dac/" title="STM32 Воспроизведение звука. Настройка периферии + первый звук">STM32 Воспроизведение звука. Настройка периферии + первый звук</a></li>
				<li><a href="http://mycontroller.ru/stm32-dac-primeryi-ispolzovaniya/" title="STM32 DAC Примеры использования">STM32 DAC Примеры использования</a></li>
				</ul>
		
		<div class="cleared"></div>
    </div>
</div>

		<div class="cleared"></div>
    </div>
</div>
</div><div id="text-5" class="widget widget_text"><div class="art-Block">
    <div class="art-Block-body">
<div class="art-BlockHeader">
    <div class="l"></div>
    <div class="r"></div>
    <div class="art-header-tag-icon">
        <div class="t">Немного рекламы</div>
    </div>
</div><div class="art-BlockContent">
    <div class="art-BlockContent-tl"></div>
    <div class="art-BlockContent-tr"></div>
    <div class="art-BlockContent-bl"></div>
    <div class="art-BlockContent-br"></div>
    <div class="art-BlockContent-tc"></div>
    <div class="art-BlockContent-bc"></div>
    <div class="art-BlockContent-cl"></div>
    <div class="art-BlockContent-cr"></div>
    <div class="art-BlockContent-cc"></div>
    <div class="art-BlockContent-body">
			<div class="textwidget"><script type="text/javascript"><!--
google_ad_client = "ca-pub-6213925206017237";
/* second */
google_ad_slot = "7273021636";
google_ad_width = 200;
google_ad_height = 200;
//-->
</script>
<script type="text/javascript" src="./STM32 USART. Назначение регистров_files/show_ads.js">
</script><ins style="display:inline-table;border:none;height:200px;margin:0;padding:0;position:relative;visibility:visible;width:200px"><ins id="aswift_0_anchor" style="display:block;border:none;height:200px;margin:0;padding:0;position:relative;visibility:visible;width:200px"><iframe allowtransparency="true" frameborder="0" height="200" hspace="0" marginwidth="0" marginheight="0" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){w.location.replace(h)}}" scrolling="no" vspace="0" width="200" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;"></iframe></ins></ins></div>
		
		<div class="cleared"></div>
    </div>
</div>

		<div class="cleared"></div>
    </div>
</div>
</div>

<p align="center">

</p>

</div>
</div>
<div class="cleared"></div>

<div class="art-Footer">
    <div class="art-Footer-inner">
                <div class="art-Footer-text">
<p>
<a href="http://mycontroller.ru/usart-naznachenie-registrov/#">Contact Us</a> | <a href="http://mycontroller.ru/usart-naznachenie-registrov/#">Terms of Use</a> | <a href="http://mycontroller.ru/usart-naznachenie-registrov/#">Trademarks</a> | <a href="http://mycontroller.ru/usart-naznachenie-registrov/#">Privacy Statement</a><br>Copyright © 2009 My Controller. All Rights Reserved.</p>
</div>
    </div>
    <div class="art-Footer-background">
    </div>
</div>

		<div class="cleared"></div>
    </div>
</div>
<div class="cleared"></div>
<p class="art-page-footer">Powered by <a href="http://wordpress.org/">WordPress</a> and <a href="http://www.artisteer.com/?p=wordpress_themes">WordPress Theme</a> created with Artisteer.</p>
</div>

<!-- 23 запросов. 0,292 секунд. -->
<div>
<!-- SyntaxHighlighter Stuff -->
<script type="text/javascript" src="./STM32 USART. Назначение регистров_files/shCore.js"></script>
<script type="text/javascript">
	SyntaxHighlighter.all();
</script>

</div>


</body></html>