<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0076)http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm -->
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="ru-RU" class="chrome  win"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
<title>STM32 Работа с библиотекой FatFs</title>
<script type="text/javascript" src="./STM32 Работа с библиотекой FatFs_files/script.js.Без названия"></script>
<link rel="stylesheet" href="./STM32 Работа с библиотекой FatFs_files/style.css" type="text/css" media="screen">
<!--[if IE 6]><link rel="stylesheet" href="../wp-content/themes/MyController/style.ie6.css" type="text/css" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="../wp-content/themes/MyController/style.ie7.css" type="text/css" media="screen" /><![endif]-->
<link rel="alternate" type="application/rss+xml" title="RSS-лента My Controller" href="http://mycontroller.ru/old_site/feed/default.htm">
<link rel="alternate" type="application/atom+xml" title="Atom-лента My Controller" href="http://mycontroller.ru/old_site/feed/atom/default.htm"> 
<link rel="pingback" href="http://mycontroller.ru/xmlrpc.php">
<link rel="alternate" type="application/rss+xml" title="My Controller » Лента комментариев к «STM32 Работа с библиотекой FatFs»" href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/feed/default.htm">
<link rel="stylesheet" id="msw_wpfm_scan-css" href="./STM32 Работа с библиотекой FatFs_files/wordpress-file-monitor.php@ver=scan" type="text/css" media="all">
<link rel="stylesheet" id="bwp-syntax-css" href="./STM32 Работа с библиотекой FatFs_files/bwp-syntax.css@ver=3.3.1" type="text/css" media="all">
<link rel="stylesheet" id="wp-downloadmanager-css" href="./STM32 Работа с библиотекой FatFs_files/download-css.css@ver=1.50" type="text/css" media="all">
<link rel="stylesheet" id="wp-pagenavi-css" href="./STM32 Работа с библиотекой FatFs_files/pagenavi-css.css@ver=2.70" type="text/css" media="all">
<script type="text/javascript" src="./STM32 Работа с библиотекой FatFs_files/jquery.js@ver=1.7.1"></script>
<script type="text/javascript" src="./STM32 Работа с библиотекой FatFs_files/bwp-syntax.js@ver=3.3.1"></script>
<script type="text/javascript" src="./STM32 Работа с библиотекой FatFs_files/external-tracking.min.js@ver=6.0.2"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://mycontroller.ru/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://mycontroller.ru/old_site/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="STM32 Подключаем энкодер" href="http://mycontroller.ru/old_site/stm32-podklyuchaem-enkoder/default.htm">
<link rel="next" title="STM32 FatFs. Обзор библиотечных функций" href="http://mycontroller.ru/old_site/stm32-fatfs-obzor-bibliotechnyih-funktsiy/default.htm">
<meta name="generator" content="WordPress 3.3.1">
<link rel="canonical" href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm">
<link rel="shortlink" href="http://mycontroller.ru/old_site/@p=2959">

<!-- Protected by WP-SpamFree v2.1.1.2 :: JS BEGIN -->
<script type="text/javascript" src="./STM32 Работа с библиотекой FatFs_files/wpsf-js.php"></script> 
<!-- Protected by WP-SpamFree v2.1.1.2 :: JS END -->


<link rel="stylesheet" href="./STM32 Работа с библиотекой FatFs_files/wp-syntax.css" type="text/css" media="screen">
<!-- wpSpoiler Code -->
        <script type="text/javascript">
            function wpSpoilerToggle(spoiler, link, showtext, hidetext) {
                if (spoiler.style.display != 'none') {
                    spoiler.style.display = 'none';
                    link.innerHTML = showtext;
                    link.className = 'spoiler_link_show';
                } else {
                    spoiler.style.display = 'block';
                    link.innerHTML = hidetext;
                    link.className = 'spoiler_link_hide';
                }
            }
          </script>
	<link type="text/css" rel="stylesheet" href="./STM32 Работа с библиотекой FatFs_files/shCore.css">
	<link type="text/css" rel="stylesheet" href="./STM32 Работа с библиотекой FatFs_files/shThemeDefault.css">
<!-- Google Analytics Tracking by Google Analyticator 6.0.2: http://ronaldheft.com/code/analyticator/ -->
<script type="text/javascript">window.google_analytics_uacct = "UA-29082067-1";</script>
<script type="text/javascript">
	var analyticsFileTypes = [''];
	var analyticsEventTracking = 'enabled';
</script>
<!--ipt type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-29082067-1']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</scri-->
</head>
<body>
<div id="art-page-background-simple-gradient">
</div>
<div id="art-main">
<div class="art-Sheet">
    <div class="art-Sheet-tl"></div>
    <div class="art-Sheet-tr"></div>
    <div class="art-Sheet-bl"></div>
    <div class="art-Sheet-br"></div>
    <div class="art-Sheet-tc"></div>
    <div class="art-Sheet-bc"></div>
    <div class="art-Sheet-cl"></div>
    <div class="art-Sheet-cr"></div>
    <div class="art-Sheet-cc"></div>
    <div class="art-Sheet-body">
<div class="art-Header">
    <div class="art-Header-png"></div>
    <div class="art-Header-jpeg"></div>
<div class="art-Logo">
    <h1 id="name-text" class="art-Logo-name">
        <a href="http://mycontroller.ru/old_site/default.htm">My Controller</a></h1>
    <div id="slogan-text" class="art-Logo-text">
        Изучаем микроконтроллеры STM32</div>
</div>

</div>
<div class="art-nav">
	<div class="l"></div>
	<div class="r"></div>
	<ul class="art-menu">
		<li><a href="http://mycontroller.ru/old_site/default.htm"><span class="l"></span><span class="r"></span><span class="t">Home</span></a></li><li><span class="art-menu-separator"></span></li><li class="page_item page-item-10"><a href="http://mycontroller.ru/old_site/o-sayte/default.htm"><span class="l"></span><span class="r"></span><span class="t">О сайте</span></a></li><li><span class="art-menu-separator"></span></li>
<li class="page_item page-item-186"><a href="http://mycontroller.ru/old_site/programmyi/default.htm"><span class="l"></span><span class="r"></span><span class="t">СОФТ</span></a></li>
	</ul>
</div>
<div class="art-contentLayout">
<div class="art-content">



<div class="art-Post">
    <div class="art-Post-tl"></div>
    <div class="art-Post-tr"></div>
    <div class="art-Post-bl"></div>
    <div class="art-Post-br"></div>
    <div class="art-Post-tc"></div>
    <div class="art-Post-bc"></div>
    <div class="art-Post-cl"></div>
    <div class="art-Post-cr"></div>
    <div class="art-Post-cc"></div>
    <div class="art-Post-body">
<div class="art-Post-inner art-article">

<div class="art-PostContent">

<div class="navigation">
	<div class="alignleft">« <a href="http://mycontroller.ru/old_site/stm32-podklyuchaem-enkoder/default.htm" rel="prev">STM32 Подключаем энкодер</a></div>
	<div class="alignright"><a href="http://mycontroller.ru/old_site/stm32-fatfs-obzor-bibliotechnyih-funktsiy/default.htm" rel="next">STM32 FatFs. Обзор библиотечных функций</a> »</div>
</div>

</div>
<div class="cleared"></div>


</div>

		<div class="cleared"></div>
    </div>
</div>

<div class="art-Post">
    <div class="art-Post-tl"></div>
    <div class="art-Post-tr"></div>
    <div class="art-Post-bl"></div>
    <div class="art-Post-br"></div>
    <div class="art-Post-tc"></div>
    <div class="art-Post-bc"></div>
    <div class="art-Post-cl"></div>
    <div class="art-Post-cr"></div>
    <div class="art-Post-cc"></div>
    <div class="art-Post-body">
<div class="art-Post-inner art-article">
<h2 class="art-PostHeader">
<a href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm" rel="bookmark" title="Постоянная ссылка на STM32 Работа с библиотекой FatFs">
STM32 Работа с библиотекой FatFs</a>
</h2>
<div class="art-PostContent">

          <p>Столкнулся с необходимостью прикрутить к контроллеру карту памяти и работать с ней посредством файловой системы. Для этого необходима специальная библиотека. Конечно, ее возможно написать самому, но уж очень это трудоемкая работа. Поэтому решил воспользоваться чужими наработками (говорят что одна из причин технического прогресса – разделение труда).</p>
<p>Существуют свободно распространяемые библиотеки для работы с FAT. Одна из них – FatFs. Больше информации о ней на русском языке можно найти здесь <a title="http://microsin.net/programming/ARM/fatfs-file-system.html" href="http://mycontroller.ru/microsin.net/programming/ARM/fatfs-file-system.html">http://microsin.net/programming/ARM/fatfs-file-system.html</a>&nbsp;</p>
<p>Возможности данной библиотеки достаточно большие. В ней содержатся функции для работы с файлами, папками, можно читать данные из файла, сохранять данные в файле, создавать файлы, переименовать файл и др.</p>
<p>Библиотеку можно использовать для 8-ми битных контроллеров, а для 32-х разрядных и подавно. Имеется возможность работы с длинными именами файлов, в кодировке Unicode.</p>
<p>Есть смысл познакомиться с ней поближе.</p>
<p><span id="more-2959"></span>
</p><p>Для начала я скачал по указанной ссылке пример проекта с использованием FatFs, адаптированный под микроконтроллеры STM32. В этом примере работа с картой ведется через SPI. Имеется два варианта – без использования ДМА&nbsp; и с использованием оного.</p>
<p>Я пока остановился на первом варианте с перспективой перехода на второй. Правда мне пришлось немного изменить его, т.к. в оригинале используется SPI1, а у меня карта подключена к модулю SPI2.</p>
<p>Сделаю небольшой обзор необходимых файлов:</p>
<ul>
<li><strong>ff.c</strong> – именно здесь содержатся функции для работы с FAT; </li>
<li><strong>ff.h</strong> – содержит объявления функций для работы с FAT, описание различных структур, позволяет задавать режимы работы (например, разрешить/запретить использование длинных имен, максимальную длину этих имен) а также содержит некоторые макроопределения; </li>
<li><strong>fattime.c</strong> и <strong>fattime.h</strong> – самые простые файлы. Нужны для возврата текущего времени, нужного при создании файлов. В принципе, можно возвращать не текущее время, а какое-то фиксированное; </li>
<li><strong>integer.c</strong> – для определения размеров целочисленных типов; </li>
<li><strong>diskio.c</strong> и <strong>diskio.h</strong> – для связи с картой памяти. Именно diskio.c необходимо корректировать для конкретного контроллера, вся остальная часть является платформенно независимой. </li>
</ul>
<p><font color="#0a1c1f">Есть еще файлы, которые позволяют работать с кодировкой Unicode, но я его пока не включал в проект, так как для первого ознакомления он не особо нужен, а памяти занимает много. Чтобы компилятор не ругался на отсутствие этого файла, пришлось закоментировать строки 1146 и 1186 в файле ff.c</font></p>
<p><font color="#0a1c1f">Файл diskio.c я подкорректировал, так как у меня используется второй SPI</font></p>
<p><font color="#0a1c1f">Помимо указанных выше файлов в проект нужно включить следующие файлы из библиотеки StdPeriph_Lib: </font></p>
<ul>
<li>stm32f10x_gpio.h и stm32f10x_gpio.с; </li>
<li>stm32f10x_rcc.h и stm32f10x_rcc.с; </li>
<li>stm32f10x_spi.h и stm32f10x_spi.h; </li>
</ul>
<p><font color="#0a1c1f">Эти файлы нужны для работы с соответствующей периферии микроконтроллера.</font></p>
<p>Если кому интересно, указанные файлы можно скачать здесь: <strong>&nbsp;</strong><a href="http://mycontroller.ru/old_site/downloads/FatFs_for_STM32.rar@id=2"><strong>скачать</strong></a></p>
<h3 align="center">Краткий обзор некоторых&nbsp; функций</h3>
<p>Для работы с картой памяти файлах diskio.c и diskio.h&nbsp; имеются следующие функции:</p>
<ul>
<li>DSTATUS <strong>disk_initialize</strong> (BYTE); </li>
<li>DSTATUS <strong>disk_status</strong> (BYTE); </li>
<li>DRESULT <strong>disk_read</strong> (BYTE, BYTE*, DWORD, BYTE); </li>
<li>DRESULT <strong>disk_write</strong>(BYTE, const BYTE*, DWORD, BYTE); </li>
<li>DRESULT <strong>disk_ioctl</strong> (BYTE, BYTE, void*); </li>
</ul>
<p><u>DSTATUS <strong>disk_initialize</strong> (BYTE drv)</u> – используется для инициализации диска. Она определяет тип карты, присутствует ли она вообще, включена ли защита от записи и т.д. Если ты только подключил карту и хочешь проверить результат своего творчества, то нужно использовать именно эту функцию. В качестве аргумента передаем ноль. </p>
<p>В качестве результата возвращается состояние диска. Результат также сохраняется в глобальной переменной Stat. В ней задействованы три младших разряда, которые являются отдельными флагами. В файле diskio.h для этого имеются следующие макроопределения:</p>
<ul>
<li>STA_NOINIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0×01&nbsp;&nbsp;&nbsp; — диск не инициализирован;      </li>
<li>STA_NODISK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0×02&nbsp;&nbsp;&nbsp; — нет карты памяти; </li>
<li>STA_PROTECT&nbsp;&nbsp;&nbsp;&nbsp; 0×04&nbsp;&nbsp;&nbsp; — включена защита от записи </li>
</ul>
<p>Анализируя результат функции disk_initialize можем судить о состоянии диска (читай <em>карты памяти</em>). Если результат равен нулю, значит все окей, если установлен один из трех младших разрядов или их комбинация – значит есть какая-то бяка. Анализируя каждый разряд поймем в чем проблема.</p>
<p><u>DSTATUS <strong>disk_status</strong> (BYTE drv)</u> – позволяет в любое время прочитать значение переменной Stat, указывающей на состояние диска. Аргумент – номер диска(0).</p>
<p><u>DRESULT <strong>disk_read</strong> (BYTE drv, BYTE* buff, DWORD sector, BYTE count)</u> – позволяет прочитать нужное количество секторов (count = 1..128) начиная с указанного сектора (sector) в указанный буфер (buff). С аргументом drv мы уже знакомы.</p>
<p>При работе с FAT к этой функции обращаться не придется, но она очень интересна, т.к. ее (а также следующую функцию) можно использовать для своих нужд без использования FAT.</p>
<p>Возвращаемое значение имеет тип <em>DRESULT, </em>который представляет собой перечисленный тип, который описан в diskio.h:</p>

<div class="wp_syntax"><table><tbody><tr><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre class="c" style="font-family:monospace;"><span style="color: #993333;">typedef</span> <span style="color: #000000; font-weight: bold;">enum</span> 
<span style="color: #009900;">{</span>
  RES_OK <span style="color: #339933;">=</span> <span style="color: #0000dd;">0</span><span style="color: #339933;">,</span>    <span style="color: #666666; font-style: italic;">//операция выполнена нормально</span>
  RES_ERROR<span style="color: #339933;">,</span>     <span style="color: #666666; font-style: italic;">//какая-то аппаратная ошибка (проблема с картой и т.д.)</span>
  RES_WRPRT<span style="color: #339933;">,</span>     <span style="color: #666666; font-style: italic;">//включена защита от записи (используется при записи секторов)</span>
  RES_NOTRDY<span style="color: #339933;">,</span>    <span style="color: #666666; font-style: italic;">//диск не был инициализирован</span>
  RES_PARERR     <span style="color: #666666; font-style: italic;">//передали неверный параметр (например count = 0)</span>
<span style="color: #009900;">}</span> DRESULT<span style="color: #339933;">;</span></pre></td></tr></tbody></table></div>

<p><u>DRESULT <strong>disk_write</strong>(BYTE drv , const BYTE* buff, DWORD sector, BYTE count)</u> – позволяет<u> </u>записать нужное количество секторов на карту, начиная с указанного сектора. Передаваемые аргументы и возвращаемый результат такие же как и в предыдущей функции.</p>
<p>Если нет необходимости записывать данные на диск, то данную функцию можно отключить макросом&nbsp; _READONLY в файле diskio.h присвоив ему значение, отличное от нуля.</p>
<p>&nbsp;</p>
<p>Чуть не забыл самое главное. Чтобы перечисленные выше ф-ии нормально работали, необходимо настроить один из таймеров контроллера на прерывание через каждые 10мс, а в каждом прерывании необходимо вызывать функцию <strong>disk_timerproc</strong>. Это нужно для всяких таймаутов. Короче, нужно.</p>
<p><strong></strong></p>
<p>Описание функций библиотеки FatFs приведу в следующей статье. А пока подключаем карту памяти, выполняем инициализацию таймера, в прерывании которого обращаемся к&nbsp; disk_timerproc. Затем в функции main&nbsp; вызываем&nbsp; disk_initialize. Если она возвращает ноль – радостно хлопаем в ладоши, иначе – чешим затылок и думаем: <em>“а чё оно не работает”</em></p>
                  
</div>
<div class="cleared"></div>
<div class="art-PostFooterIcons art-metadata-icons">
Рубрика: <a href="http://mycontroller.ru/old_site/category/mikrokontrolleryi-stm32/default.htm" title="Просмотреть все записи в рубрике «МИКРОКОНТРОЛЛЕРЫ STM32»" rel="category tag">МИКРОКОНТРОЛЛЕРЫ STM32</a>, <a href="http://mycontroller.ru/old_site/category/vneshnie-ustroystva/karta-pamyati-sd/rabota-s-ffatfs/default.htm" title="Просмотреть все записи в рубрике «Работа с FatFs»" rel="category tag">Работа с FatFs</a>
</div>

</div>

		<div class="cleared"></div>
    </div>
</div>


<!-- You can start editing here. -->


<div class="art-Post">
    <div class="art-Post-tl"></div>
    <div class="art-Post-tr"></div>
    <div class="art-Post-bl"></div>
    <div class="art-Post-br"></div>
    <div class="art-Post-tc"></div>
    <div class="art-Post-bc"></div>
    <div class="art-Post-cl"></div>
    <div class="art-Post-cr"></div>
    <div class="art-Post-cc"></div>
    <div class="art-Post-body">
<div class="art-Post-inner art-article">

<div class="art-PostContent">

<h3 id="comments">Комментарии (10) на “STM32 Работа с библиотекой FatFs”</h3>



</div>
<div class="cleared"></div>


</div>

		<div class="cleared"></div>
    </div>
</div>


	<ul class="commentlist">
       <li class="comment even thread-even depth-1" id="li-comment-1349">
     <div id="comment-1349">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">Apparatchik:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm#comment-1349">01.10.2012 в 17:18</a></div>

      <p>Что конкретно нужно изменить в файле diskio.c чтоб использовать SPI1 ?</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/@replytocom=1349#respond" onclick="return addComment.moveForm(&quot;comment-1349&quot;, &quot;1349&quot;, &quot;respond&quot;, &quot;2959&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
<ul class="children">
   <li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-1350">
     <div id="comment-1350">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">kontroller:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm#comment-1350">01.10.2012 в 19:21</a></div>

      <p>Ниже приведена ссылка сайта, где содержаться проекты под FatFs для разных контроллеров. В примере для STM32 используется SPI1. Я использовал его для своего проекта, переделав под SPI2.<br>
Можете взять его для STM32<br>
 <a href="http://mycontroller.ru/www.siwawi.arubi.uni-kl.de/avr_projects/arm_projects/arm_memcards/index.html" rel="nofollow">http://www.siwawi.arubi.uni-kl.de/avr_projects/arm_projects/arm_memcards/index.html</a></p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/@replytocom=1350#respond" onclick="return addComment.moveForm(&quot;comment-1350&quot;, &quot;1350&quot;, &quot;respond&quot;, &quot;2959&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
</li>
   <li class="comment even depth-2" id="li-comment-2473">
     <div id="comment-2473">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">Dmitry:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm#comment-2473">14.12.2012 в 01:45</a></div>

      <p>Парочка power_on() для SPI1 (PB4, PB5, PB6, PB7) и SPI1 remap (PB3, PB4, PB5, PA15)</p>
<p>/*————————————————————————*/<br>
/* Power Control and interface-initialization (Platform dependent)       */<br>
/*————————————————————————*/<br>
// remapped SPI init for PB3-PB5 and PA15<br>
static<br>
void power_on(void)<br>
{<br>
	RCC-&gt;APB2ENR |= RCC_APB2ENR_AFIOEN;//включить тактирование альтернативных функций<br>
	RCC-&gt;APB2ENR |= RCC_APB2ENR_IOPAEN;//включить тактирование порта А<br>
	RCC-&gt;APB2ENR |= RCC_APB2ENR_IOPBEN;//включить тактирование порта b</p>
<p>	GPIO_PinRemapConfig(GPIO_Remap_SWJ_JTAGDisable, ENABLE); // отключаем JTAG<br>
	GPIO_PinRemapConfig(GPIO_Remap_SPI1, ENABLE); // включаем ремап SPI1</p>
<p>	//вывод управления SS: выход двухтактный, общего назначения,50MHz<br>
	GPIOA-&gt;CRH |= GPIO_CRH_MODE15; //<br>
	GPIOA-&gt;CRH &amp;= ~GPIO_CRH_CNF15; //<br>
	GPIOA-&gt;BSRR = GPIO_BSRR_BS15; //</p>
<p>	//вывод SCK: выход двухтактный, альтернативная функция, 50MHz<br>
	GPIOB-&gt;CRL |= GPIO_CRL_MODE3; //<br>
	GPIOB-&gt;CRL &amp;= ~GPIO_CRL_CNF3; //<br>
	GPIOB-&gt;CRL |= GPIO_CRL_CNF3_1; //</p>
<p>	//вывод MISO: вход цифровой с подтягивающим резистором, подтяжка к плюсу<br>
	GPIOB-&gt;CRL &amp;= ~GPIO_CRL_MODE4; //<br>
	GPIOB-&gt;CRL &amp;= ~GPIO_CRL_CNF4; //<br>
	GPIOB-&gt;CRL |= GPIO_CRL_CNF4_1; //<br>
	GPIOB-&gt;BSRR = GPIO_BSRR_BS4; //</p>
<p>	//вывод MOSI: выход двухтактный, альтернативная функция, 50MHz<br>
	GPIOB-&gt;CRL |= GPIO_CRL_MODE5; //<br>
	GPIOB-&gt;CRL &amp;= ~GPIO_CRL_CNF5; //<br>
	GPIOB-&gt;CRL |= GPIO_CRL_CNF5_1; //</p>
<p>	//настроить модуль SPI<br>
	RCC-&gt;APB2ENR |= RCC_APB2ENR_SPI1EN; //подать тактирование<br>
	SPI1-&gt;CR2 = 0×0000; //<br>
	SPI1-&gt;CR1 = SPI_CR1_MSTR; //контроллер должен быть мастером,конечно<br>
	SPI1-&gt;CR1 |= SPI_CR1_BR; //для начала зададим маленькую скорость<br>
	SPI1-&gt;CR1 |= SPI_CR1_SSI;<br>
	SPI1-&gt;CR1 |= SPI_CR1_SSM;<br>
	SPI1-&gt;CR1 |= SPI_CR1_SPE; //разрешить работу модуля SPI</p>
<p>}</p>
<p>// SPI1 init for PA4-PA7<br>
static void power_on2(void){</p>
<p>	RCC-&gt;APB2ENR |= RCC_APB2ENR_AFIOEN;//включить тактирование альтернативных функций<br>
	RCC-&gt;APB2ENR |= RCC_APB2ENR_IOPAEN;//включить тактирование порта А</p>
<p>	//вывод управления SS: выход двухтактный, общего назначения,50MHz<br>
	GPIOA-&gt;CRL |= GPIO_CRL_MODE4; //<br>
	GPIOA-&gt;CRL &amp;= ~GPIO_CRL_CNF4; //<br>
	GPIOA-&gt;BSRR = GPIO_BSRR_BS4; //</p>
<p>	//вывод SCK: выход двухтактный, альтернативная функция, 50MHz<br>
	GPIOA-&gt;CRL |= GPIO_CRL_MODE5; //<br>
	GPIOA-&gt;CRL &amp;= ~GPIO_CRL_CNF5; //<br>
	GPIOA-&gt;CRL |= GPIO_CRL_CNF5_1; //</p>
<p>	//вывод MISO: вход цифровой с подтягивающим резистором, подтяжка к плюсу<br>
	GPIOA-&gt;CRL &amp;= ~GPIO_CRL_MODE6; //<br>
	GPIOA-&gt;CRL &amp;= ~GPIO_CRL_CNF6; //<br>
	GPIOA-&gt;CRL |= GPIO_CRL_CNF6_1; //<br>
	GPIOA-&gt;BSRR = GPIO_BSRR_BS6; //</p>
<p>	//вывод MOSI: выход двухтактный, альтернативная функция, 50MHz<br>
	GPIOA-&gt;CRL |= GPIO_CRL_MODE7; //<br>
	GPIOA-&gt;CRL &amp;= ~GPIO_CRL_CNF7; //<br>
	GPIOA-&gt;CRL |= GPIO_CRL_CNF7_1; //</p>
<p>	//настроить модуль SPI<br>
	RCC-&gt;APB2ENR |= RCC_APB2ENR_SPI1EN; //подать тактирование<br>
	SPI1-&gt;CR2 = 0×0000; //<br>
	SPI1-&gt;CR1 = SPI_CR1_MSTR; //контроллер должен быть мастером,конечно<br>
	SPI1-&gt;CR1 |= SPI_CR1_BR; //для начала зададим маленькую скорость<br>
	SPI1-&gt;CR1 |= SPI_CR1_SSI;<br>
	SPI1-&gt;CR1 |= SPI_CR1_SSM;<br>
	SPI1-&gt;CR1 |= SPI_CR1_SPE; //разрешить работу модуля SPI<br>
}</p>
<p>stm32vl-discovery, stm32f100</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/@replytocom=2473#respond" onclick="return addComment.moveForm(&quot;comment-2473&quot;, &quot;2473&quot;, &quot;respond&quot;, &quot;2959&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
</li>
</ul>
</li>
   <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1497">
     <div id="comment-1497">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">scynet:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm#comment-1497">14.10.2012 в 16:00</a></div>

      <p>Интересно это все конечно, но самое главное не сказано, какой тип памяти используется и если это NAND, то где оптимизационный алгоритм ?</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/@replytocom=1497#respond" onclick="return addComment.moveForm(&quot;comment-1497&quot;, &quot;1497&quot;, &quot;respond&quot;, &quot;2959&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
</li>
   <li class="comment even thread-even depth-1" id="li-comment-2242">
     <div id="comment-2242">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">Jura:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm#comment-2242">18.11.2012 в 13:21</a></div>

      <p>Подскажи пожалуйсто почему при использовании твоей библиотеки в IAR выдаёт ошибки:<br>
Building configuration: dataflash — Debug<br>
Updating build tree…<br>
diskio.c<br>
Error[Pe144]: a value of type «void *» cannot be used to initialize an entity of type «BYTE *» D:\DATAFLASH\Libraries\ff9a\src\diskio.c 656<br>
Error while running C/C++ Compiler<br>
ff.c<br>
Warning[Pe111]: statement is unreachable D:\DATAFLASH\Libraries\ff9a\src\ff.c 1141<br>
Error[Pe144]: a value of type «void *» cannot be used to initialize an entity of type «BYTE *» D:\DATAFLASH\Libraries\ff9a\src\ff.c 1728<br>
Error[Pe144]: a value of type «void const *» cannot be used to initialize an entity of type «BYTE const *» D:\DATAFLASH\Libraries\ff9a\src\ff.c 1815<br>
Error while running C/C++ Compiler<br>
main.cpp  </p>
<p>Total number of errors: 3<br>
Total number of warnings: 1</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/@replytocom=2242#respond" onclick="return addComment.moveForm(&quot;comment-2242&quot;, &quot;2242&quot;, &quot;respond&quot;, &quot;2959&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
</li>
   <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-2460">
     <div id="comment-2460">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">Dmitry:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm#comment-2460">11.12.2012 в 22:30</a></div>

      <p>Подскажи, пожалуйста, я правильно понимаю, что в твоём случае с FatFs имел место быть отказ от интеграции предыдущих наработок вроде SD_init, SD_ReadSector в пользу готовых power_on, rcvr_datablock и xmit_datablock из примера уважаемого ChaNа?<br>
А то я попробовал интегрировать SD_init, SD_ReadSector, SD_WriteSector (которые успешно работают для посекторной работы) в версию 0.09 и что-то не пошло. Завал случился на f_open, который возвращает 1. Типы возвращаемых результатов не совпадают?<br>
А в примере Чана очень суровая инициализация и у меня всё виснет. Там 103 чип, а у меня 100, может поэтому? Подозрения вызывает строка с комментом 72/4</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/@replytocom=2460#respond" onclick="return addComment.moveForm(&quot;comment-2460&quot;, &quot;2460&quot;, &quot;respond&quot;, &quot;2959&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
<ul class="children">
   <li class="comment byuser comment-author-admin bypostauthor even depth-2" id="li-comment-2461">
     <div id="comment-2461">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">kontroller:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm#comment-2461">11.12.2012 в 22:40</a></div>

      <p>Я использовал пример Чана и чип 100. Работает нормально.<br>
Если возвращает 1, то насколько я помню это код ошибки «диск не инициализирован»<br>
Прежде чем читать диск нужно выполнить монтирование диска. Делается это так:<br>
  FATFS fs;<br>
  f_mount(0, &amp;fs);</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/@replytocom=2461#respond" onclick="return addComment.moveForm(&quot;comment-2461&quot;, &quot;2461&quot;, &quot;respond&quot;, &quot;2959&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
<ul class="children">
   <li class="comment odd alt depth-3" id="li-comment-2462">
     <div id="comment-2462">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">Dmitry:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm#comment-2462">12.12.2012 в 02:58</a></div>

      <p>Представляешь, я заменил содержимое функции power_on на spi_init() (<a href="http://mycontroller.ru/electronics-archive.ru/stm32-sd-card-_25D0_25B2_25D0_25B2_25D0_25B5_25D0_25B4_25D0_25B5_25D0_25BD_25D0_25B8_25D0_25B5.html" rel="nofollow">http://electronics-archive.ru/stm32-sd-card-%D0%B2%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5.html</a>):</p>
<p>RCC-&gt;APB2ENR |= RCC_APB2ENR_AFIOEN;//включить тактирование альтернативных функций<br>
RCC-&gt;APB2ENR |= RCC_APB2ENR_IOPAEN;//включить тактирование порта А</p>
<p>//вывод управления SS: выход двухтактный, общего назначения,50MHz<br>
GPIOA-&gt;CRL |= GPIO_CRL_MODE4; //<br>
GPIOA-&gt;CRL &amp;= ~GPIO_CRL_CNF4; //<br>
GPIOA-&gt;BSRR = GPIO_BSRR_BS4; //</p>
<p>//вывод SCK: выход двухтактный, альтернативная функция, 50MHz<br>
GPIOA-&gt;CRL |= GPIO_CRL_MODE5; //<br>
GPIOA-&gt;CRL &amp;= ~GPIO_CRL_CNF5; //<br>
GPIOA-&gt;CRL |= GPIO_CRL_CNF5_1; //</p>
<p>//вывод MISO: вход цифровой с подтягивающим резистором, подтяжка к плюсу<br>
GPIOA-&gt;CRL &amp;= ~GPIO_CRL_MODE6; //<br>
GPIOA-&gt;CRL &amp;= ~GPIO_CRL_CNF6; //<br>
GPIOA-&gt;CRL |= GPIO_CRL_CNF6_1; //<br>
GPIOA-&gt;BSRR = GPIO_BSRR_BS6; //</p>
<p>//вывод MOSI: выход двухтактный, альтернативная функция, 50MHz<br>
GPIOA-&gt;CRL |= GPIO_CRL_MODE7; //<br>
GPIOA-&gt;CRL &amp;= ~GPIO_CRL_CNF7; //<br>
GPIOA-&gt;CRL |= GPIO_CRL_CNF7_1; //</p>
<p>//настроить модуль SPI<br>
RCC-&gt;APB2ENR |= RCC_APB2ENR_SPI1EN; //подать тактирование<br>
SPI1-&gt;CR2 = 0×0000; //<br>
SPI1-&gt;CR1 = SPI_CR1_MSTR; //контроллер должен быть мастером,конечно<br>
SPI1-&gt;CR1 |= SPI_CR1_BR; //для начала зададим маленькую скорость<br>
SPI1-&gt;CR1 |= SPI_CR1_SSI;<br>
SPI1-&gt;CR1 |= SPI_CR1_SSM;<br>
SPI1-&gt;CR1 |= SPI_CR1_SPE; //разрешить работу модуля SPI</p>
<p>и файл записался.</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/@replytocom=2462#respond" onclick="return addComment.moveForm(&quot;comment-2462&quot;, &quot;2462&quot;, &quot;respond&quot;, &quot;2959&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
</li>
</ul>
</li>
   <li class="comment even depth-2" id="li-comment-2475">
     <div id="comment-2475">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">Dmitry:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm#comment-2475">15.12.2012 в 03:24</a></div>

      <p>Проблема с невозможностью запустить пример Томаса, похоже, в строке:<br>
for (Timer1 = 250; Timer1; );	/* Wait for 250ms */<br>
решилась заменой этой строки на набор из слегка подрежактированой пары кусков отсюда <a href="http://mycontroller.ru/old_site/stm32-timer-funktsiya-zaderzhki/default.htm" rel="nofollow">http://mycontroller.ru/stm32-timer-funktsiya-zaderzhki/</a></p>
<p>Вот то, что я посставил в функции power_on() из примера Томаса, вместо вышеприведёной строки:<br>
	 RCC-&gt;APB1ENR |= RCC_APB1ENR_TIM2EN;   //подать тактирование на TIM2<br>
	 TIM2-&gt;PSC     = 8000-1;               //настроить делитель для формирования миллисекунд<br>
	 TIM2-&gt;CR1     = TIM_CR1_OPM;          //режим одного импульса<br>
	  TIM2-&gt;ARR = 250;                  //загрузить значение задержки<br>
	  TIM2-&gt;CNT = 0;<br>
	  TIM2-&gt;CR1 = TIM_CR1_CEN;	      //запустить таймер<br>
	  while((TIM2-&gt;SR &amp; TIM_SR_UIF)==0){} //дождаться конца задержки<br>
	  TIM2-&gt;SR &amp;= ~TIM_SR_UIF;	      //сбросить флаг</p>
<p>файл записался на SPI1<br>
попробую для ремапа SPI1 ещё</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/@replytocom=2475#respond" onclick="return addComment.moveForm(&quot;comment-2475&quot;, &quot;2475&quot;, &quot;respond&quot;, &quot;2959&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
<ul class="children">
   <li class="comment byuser comment-author-admin bypostauthor odd alt depth-3" id="li-comment-2477">
     <div id="comment-2477">
<div class="art-Post">
         <div class="art-Post-tl"></div>
         <div class="art-Post-tr"></div>
         <div class="art-Post-bl"></div>
         <div class="art-Post-br"></div>
         <div class="art-Post-tc"></div>
         <div class="art-Post-bc"></div>
         <div class="art-Post-cl"></div>
         <div class="art-Post-cr"></div>
         <div class="art-Post-cc"></div>
         <div class="art-Post-body">
     <div class="art-Post-inner art-article">
     
<div class="art-PostContent">
     
      <div class="comment-author vcard">
                  <cite class="fn">kontroller:</cite>
      </div>
      
      <div class="comment-meta commentmetadata"><a href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm#comment-2477">15.12.2012 в 16:41</a></div>

      <p>А Вы не работали с русской кодировкой в именах файлов?<br>
А то у меня с этим небольшой затык.<br>
Проблема возникает с русскими буквами в коротком имени файла.</p>

      <div class="reply">
         <a class="comment-reply-link" href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/@replytocom=2477#respond" onclick="return addComment.moveForm(&quot;comment-2477&quot;, &quot;2477&quot;, &quot;respond&quot;, &quot;2959&quot;)">Ответить</a>      </div>

      </div>
      <div class="cleared"></div>
      

      </div>
      
      		<div class="cleared"></div>
          </div>
      </div>
      
     </div>
</li>
</ul>
</li>
</ul>
</li>
  </ul>


 

<div class="art-Post">
    <div class="art-Post-tl"></div>
    <div class="art-Post-tr"></div>
    <div class="art-Post-bl"></div>
    <div class="art-Post-br"></div>
    <div class="art-Post-tc"></div>
    <div class="art-Post-bc"></div>
    <div class="art-Post-cl"></div>
    <div class="art-Post-cr"></div>
    <div class="art-Post-cc"></div>
    <div class="art-Post-body">
<div class="art-Post-inner art-article">

<div class="art-PostContent">

<div id="respond">
  
  <h3>Оставить комментарий</h3>

<div class="cancel-comment-reply">
	<small><a rel="nofollow" id="cancel-comment-reply-link" href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm#respond" style="display:none;">Нажмите, чтобы отменить ответ.</a></small>
</div>


<form action="http://mycontroller.ru/old_site/wp-comments-post.php" method="post" id="commentform">


<p><input type="text" name="author" id="author" value="" size="22" tabindex="1">
<label for="author"><small>Имя </small></label></p>

<p><input type="text" name="email" id="email" value="" size="22" tabindex="2">
<label for="email"><small>E-mail (не публикуется) </small></label></p>

<p><input type="text" name="url" id="url" value="" size="22" tabindex="3">
<label for="url"><small>Web-сайт</small></label></p>


<!--<p><small><strong>XHTML:</strong> Вы можете использовать эту разметку: <code>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code lang=&quot;&quot;&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; &lt;pre lang=&quot;&quot; extra=&quot;&quot;&gt; </code></small></p>-->

<p><textarea name="comment" id="comment" cols="100%" rows="10" tabindex="4"></textarea></p>

<p>
	<span class="art-button-wrapper">
		<span class="l"> </span>
		<span class="r"> </span>
		<input class="art-button" type="submit" name="submit" tabindex="5" value="Отправить">
	</span>
<input type="hidden" name="comment_post_ID" value="2959" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p>
	<script type="text/javascript">
	<!--
	refJS = escape( document[ 'referrer' ] );
	document.write("<input type='hidden' name='refJS' value='"+refJS+"'>");
	// -->
	</script><input type="hidden" name="refJS" value="http%3A//mycontroller.ru/old_site/stm32-podklyuchaem-enkoder/default.htm">
	<p style="font-size:9px;clear:both;">Spam Protection by <a href="http://mycontroller.ru/www.polepositionmarketing.com/library/wp-spamfree/default.htm" title="WP-SpamFree WordPress Anti-Spam Plugin">WP-SpamFree</a></p>

</form>

</div>

</div>
<div class="cleared"></div>


</div>

		<div class="cleared"></div>
    </div>
</div>


</div>
<div class="art-sidebar1">      
<div id="mycategoryorder-2" class="widget widget_mycategoryorder"><div class="art-Block">
    <div class="art-Block-body">
<div class="art-BlockHeader">
    <div class="l"></div>
    <div class="r"></div>
    <div class="art-header-tag-icon">
        <div class="t">Рубрики</div>
    </div>
</div><div class="art-BlockContent">
    <div class="art-BlockContent-tl"></div>
    <div class="art-BlockContent-tr"></div>
    <div class="art-BlockContent-bl"></div>
    <div class="art-BlockContent-br"></div>
    <div class="art-BlockContent-tc"></div>
    <div class="art-BlockContent-bc"></div>
    <div class="art-BlockContent-cl"></div>
    <div class="art-BlockContent-cr"></div>
    <div class="art-BlockContent-cc"></div>
    <div class="art-BlockContent-body">
		<ul>
			<li class="cat-item cat-item-3"><a href="http://mycontroller.ru/old_site/category/mikrokontrolleryi-stm32/default.htm" title="Просмотреть все записи в рубрике «МИКРОКОНТРОЛЛЕРЫ STM32»">МИКРОКОНТРОЛЛЕРЫ STM32</a>
<ul class="children">
	<li class="cat-item cat-item-7"><a href="http://mycontroller.ru/old_site/category/mikrokontrolleryi-stm32/bootloader/default.htm" title="Просмотреть все записи в рубрике «Bootloader»">Bootloader</a>
</li>
	<li class="cat-item cat-item-14"><a href="http://mycontroller.ru/old_site/category/mikrokontrolleryi-stm32/portyi-vvoda-vyivoda/default.htm" title="Просмотреть все записи в рубрике «GPIO»">GPIO</a>
</li>
	<li class="cat-item cat-item-4"><a href="http://mycontroller.ru/old_site/category/mikrokontrolleryi-stm32/usart/default.htm" title="Просмотреть все записи в рубрике «USART»">USART</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://mycontroller.ru/old_site/category/mikrokontrolleryi-stm32/dma/default.htm" title="Просмотреть все записи в рубрике «DMA»">DMA</a>
</li>
	<li class="cat-item cat-item-15"><a href="http://mycontroller.ru/old_site/category/mikrokontrolleryi-stm32/bkp-registryi/default.htm" title="Просмотреть все записи в рубрике «BKP»">BKP</a>
</li>
	<li class="cat-item cat-item-8"><a href="http://mycontroller.ru/old_site/category/mikrokontrolleryi-stm32/rtc/default.htm" title="Просмотреть все записи в рубрике «RTC»">RTC</a>
</li>
	<li class="cat-item cat-item-16"><a href="http://mycontroller.ru/old_site/category/mikrokontrolleryi-stm32/timer/default.htm" title="Просмотреть все записи в рубрике «TIMER»">TIMER</a>
</li>
	<li class="cat-item cat-item-21"><a href="http://mycontroller.ru/old_site/category/mikrokontrolleryi-stm32/spi/default.htm" title="Просмотреть все записи в рубрике «SPI»">SPI</a>
</li>
	<li class="cat-item cat-item-24"><a href="http://mycontroller.ru/old_site/category/mikrokontrolleryi-stm32/adc/default.htm" title="Просмотреть все записи в рубрике «ADC»">ADC</a>
</li>
	<li class="cat-item cat-item-25"><a href="http://mycontroller.ru/old_site/category/mikrokontrolleryi-stm32/dac/default.htm" title="Просмотреть все записи в рубрике «DAC»">DAC</a>
</li>
	<li class="cat-item cat-item-26"><a href="http://mycontroller.ru/old_site/category/mikrokontrolleryi-stm32/usb/default.htm" title="Просмотреть все записи в рубрике «USB»">USB</a>
</li>
</ul>
</li>
	<li class="cat-item cat-item-19"><a href="http://mycontroller.ru/old_site/category/vneshnie-ustroystva/default.htm" title="Просмотреть все записи в рубрике «ВНЕШНИЕ УСТРОЙСТВА»">ВНЕШНИЕ УСТРОЙСТВА</a>
<ul class="children">
	<li class="cat-item cat-item-23"><a href="http://mycontroller.ru/old_site/category/vneshnie-ustroystva/termodatchik-ds18b20/default.htm" title="Просмотреть все записи в рубрике «Термодатчик ds18b20»">Термодатчик ds18b20</a>
</li>
	<li class="cat-item cat-item-29"><a href="http://mycontroller.ru/old_site/category/vneshnie-ustroystva/enkoder/default.htm" title="Просмотреть все записи в рубрике «Энкодер»">Энкодер</a>
</li>
	<li class="cat-item cat-item-20"><a href="http://mycontroller.ru/old_site/category/vneshnie-ustroystva/karta-pamyati-sd/default.htm" title="Просмотреть все записи в рубрике «Карта памяти SD»">Карта памяти SD</a>
	<ul class="children">
	<li class="cat-item cat-item-31"><a href="http://mycontroller.ru/old_site/category/vneshnie-ustroystva/karta-pamyati-sd/rabota-s-ffatfs/default.htm" title="Просмотреть все записи в рубрике «Работа с FatFs»">Работа с FatFs</a>
</li>
	</ul>
</li>
</ul>
</li>
	<li class="cat-item cat-item-1"><a href="http://mycontroller.ru/old_site/category/bez-rubriki/default.htm" title="Просмотреть все записи в рубрике «МОИ ПРОЕКТЫ»">МОИ ПРОЕКТЫ</a>
<ul class="children">
	<li class="cat-item cat-item-6"><a href="http://mycontroller.ru/old_site/category/bez-rubriki/chasyi-na-stm32f100rb/default.htm" title="Просмотреть все записи в рубрике «Часы на STM32F100RB»">Часы на STM32F100RB</a>
</li>
	<li class="cat-item cat-item-28"><a href="http://mycontroller.ru/old_site/category/bez-rubriki/umnyiy-dom/default.htm" title="Просмотреть все записи в рубрике «Умный Дом»">Умный Дом</a>
</li>
	<li class="cat-item cat-item-30"><a href="http://mycontroller.ru/old_site/category/bez-rubriki/waveplayer/default.htm" title="Просмотреть все записи в рубрике «WavePlayer»">WavePlayer</a>
</li>
	<li class="cat-item cat-item-32"><a href="http://mycontroller.ru/old_site/category/bez-rubriki/sintezator-eliza/default.htm" title="Просмотреть все записи в рубрике «Синтезатор &quot;Элиза&quot;»">Синтезатор "Элиза"</a>
</li>
</ul>
</li>
	<li class="cat-item cat-item-10"><a href="http://mycontroller.ru/old_site/category/poleznyiy-soft/default.htm" title="Просмотреть все записи в рубрике «ПОЛЕЗНЫЙ СОФТ»">ПОЛЕЗНЫЙ СОФТ</a>
<ul class="children">
	<li class="cat-item cat-item-11"><a href="http://mycontroller.ru/old_site/category/poleznyiy-soft/stm32-generator-koda/default.htm" title="Просмотреть все записи в рубрике «STM32 генератор»">STM32 генератор</a>
</li>
</ul>
</li>
		</ul>
		
		<div class="cleared"></div>
    </div>
</div>

		<div class="cleared"></div>
    </div>
</div>
</div>		<div id="recent-posts-2" class="widget widget_recent_entries"><div class="art-Block">
    <div class="art-Block-body">
		<div class="art-BlockHeader">
    <div class="l"></div>
    <div class="r"></div>
    <div class="art-header-tag-icon">
        <div class="t">Свежие записи</div>
    </div>
</div><div class="art-BlockContent">
    <div class="art-BlockContent-tl"></div>
    <div class="art-BlockContent-tr"></div>
    <div class="art-BlockContent-bl"></div>
    <div class="art-BlockContent-br"></div>
    <div class="art-BlockContent-tc"></div>
    <div class="art-BlockContent-bc"></div>
    <div class="art-BlockContent-cl"></div>
    <div class="art-BlockContent-cr"></div>
    <div class="art-BlockContent-cc"></div>
    <div class="art-BlockContent-body">
		<ul>
				<li><a href="http://mycontroller.ru/old_site/stm32-interfeys-i2c-opisanie/default.htm" title="STM32 Интерфейс I2C. Описание">STM32 Интерфейс I2C. Описание</a></li>
				<li><a href="http://mycontroller.ru/old_site/stm32-sintezator-rechi-ldquo-eliza-rdquo-prodolzhenie/default.htm" title="STM32 Синтезатор речи “Элиза”. Продолжение">STM32 Синтезатор речи “Элиза”. Продолжение</a></li>
				<li><a href="http://mycontroller.ru/old_site/stm32-sintezator-rechi-ldquo-eliza-rdquo/default.htm" title="STM32 Синтезатор речи “Элиза”">STM32 Синтезатор речи “Элиза”</a></li>
				<li><a href="http://mycontroller.ru/old_site/stm32-generator-koda-novaya-versiya/default.htm" title="STM32 Генератор кода. Новая версия">STM32 Генератор кода. Новая версия</a></li>
				<li><a href="http://mycontroller.ru/old_site/stm32-generator-koda-konstruktor-komponentov/default.htm" title="STM32 “Конструктор компонентов” для “Генератора кода”">STM32 “Конструктор компонентов” для “Генератора кода”</a></li>
				</ul>
		
		<div class="cleared"></div>
    </div>
</div>

		<div class="cleared"></div>
    </div>
</div>
</div><div id="text-5" class="widget widget_text"><div class="art-Block">
    <div class="art-Block-body">
<div class="art-BlockHeader">
    <div class="l"></div>
    <div class="r"></div>
    <div class="art-header-tag-icon">
        <div class="t">Немного рекламы</div>
    </div>
</div><div class="art-BlockContent">
    <div class="art-BlockContent-tl"></div>
    <div class="art-BlockContent-tr"></div>
    <div class="art-BlockContent-bl"></div>
    <div class="art-BlockContent-br"></div>
    <div class="art-BlockContent-tc"></div>
    <div class="art-BlockContent-bc"></div>
    <div class="art-BlockContent-cl"></div>
    <div class="art-BlockContent-cr"></div>
    <div class="art-BlockContent-cc"></div>
    <div class="art-BlockContent-body">
			<div class="textwidget"><script type="text/javascript"><!--
google_ad_client = "ca-pub-6213925206017237";
/* second */
google_ad_slot = "7273021636";
google_ad_width = 200;
google_ad_height = 200;
//-->
</script>
<acript type="text/javascript" src="../../pagead2.googlesyndication.com/pagead/show_ads.js">
</acript></div>
		
		<div class="cleared"></div>
    </div>
</div>

		<div class="cleared"></div>
    </div>
</div>
</div><div id="linkcat-2" class="widget widget_links"><div class="art-Block">
    <div class="art-Block-body">
<div class="art-BlockHeader">
    <div class="l"></div>
    <div class="r"></div>
    <div class="art-header-tag-icon">
        <div class="t">Ссылки</div>
    </div>
</div><div class="art-BlockContent">
    <div class="art-BlockContent-tl"></div>
    <div class="art-BlockContent-tr"></div>
    <div class="art-BlockContent-bl"></div>
    <div class="art-BlockContent-br"></div>
    <div class="art-BlockContent-tc"></div>
    <div class="art-BlockContent-bc"></div>
    <div class="art-BlockContent-cl"></div>
    <div class="art-BlockContent-cr"></div>
    <div class="art-BlockContent-cc"></div>
    <div class="art-BlockContent-body">

	<ul class="xoxo blogroll">
<li><a href="http://mycontroller.ru/old_site/forum">Форум сайта</a></li>

	</ul>

		<div class="cleared"></div>
    </div>
</div>

		<div class="cleared"></div>
    </div>
</div>
</div>


<p align="center">

</p>

</div>
</div>
<div class="cleared"></div>




<div class="art-Footer">
    <div class="art-Footer-inner">
                <div class="art-Footer-text">
<p>
<a href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm#">Contact Us</a> | <a href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm#">Terms of Use</a> | <a href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm#">Trademarks</a> | <a href="http://mycontroller.ru/old_site/stm32-rabota-s-bibliotekoy-fatfs/default.htm#">Privacy Statement</a><br>Copyright © 2009 My Controller. All Rights Reserved.</p>
</div>
    </div>
    <div class="art-Footer-background">
    </div>
</div>

		<div class="cleared"></div>
    </div>
</div>
<div class="cleared"></div>

</div>

<!-- 27 запросов. 0,308 секунд. -->
<div>
<!-- SyntaxHighlighter Stuff -->
<script type="text/javascript" src="./STM32 Работа с библиотекой FatFs_files/shCore.js.Без названия"></script>
<script type="text/javascript">
	SyntaxHighlighter.all();
</script>

</div>


</body></html>